<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:system="clr-namespace:System;assembly=mscorlib"
  xmlns:aero="clr-namespace:PresentationTheme.Aero;assembly=PresentationTheme.Aero"
  xmlns:aero10="clr-namespace:PresentationTheme.HighContrast.Win10">

  <aero10:TypeOfConverter x:Key="TypeOfConverter"/>
  <aero10:InvertThicknessConverter x:Key="InvertThicknessConverter"/>
  <aero10:EqualsConverter x:Key="EqualsConverter"/>

  <Style x:Key="{x:Static SystemParameters.FocusVisualStyleKey}">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Rectangle SnapsToDevicePixels="True"
                     Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                     StrokeThickness="1"
                     StrokeDashArray="1 1"
                     StrokeDashOffset="1.5"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="FocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Rectangle Margin="2"
                     SnapsToDevicePixels="True"
                     Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                     StrokeThickness="1"
                     StrokeDashArray="1 1"
                     StrokeDashOffset="1.5"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>


  <!-- TextBox ============================================================= -->

  <Style TargetType="{x:Type aero10:TextBoxChrome}">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type aero10:TextBoxChrome}">
          <Border x:Name="Border"
                  Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Padding="1"
                  SnapsToDevicePixels="True">
            <VisualStateManager.VisualStateGroups>
              <VisualStateGroup x:Name="BackgroundStates">
                <VisualState x:Name="BackgroundNormal"/>
                <VisualState x:Name="BackgroundHot"/>
                <VisualState x:Name="BackgroundFocused"/>
                <VisualState x:Name="BackgroundDisabled">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource TextBox.Background.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="BackgroundReadOnly">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource TextBox.Background.ReadOnly.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
              </VisualStateGroup>
              <VisualStateGroup x:Name="BorderStates">
                <VisualState x:Name="BorderNormal"/>
                <VisualState x:Name="BorderHot">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource TextBox.Border.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="BorderFocused">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource TextBox.Border.Focused.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="BorderDisabled">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource TextBox.Border.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
              </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <ContentPresenter/>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="BorderThickness" Value="0">
              <Setter TargetName="Border" Property="Padding" Value="0"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{x:Type TextBoxBase}" TargetType="{x:Type TextBoxBase}">
    <Setter Property="Background" Value="{aero10:SystemAliasResource TextBox.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource TextBox.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Padding" Value="1,2"/>
    <Setter Property="KeyboardNavigation.TabNavigation" Value="None"/>
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
    <Setter Property="AllowDrop" Value="True"/>
    <Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="IsReadOnlyCaretVisible" Value="True"/>
    <Setter Property="SelectionBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
    <Setter Property="SelectionOpacity" Value="0.5"/>
    <Setter Property="aero:TextBoxService.ViewMargin" Value="0"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type TextBoxBase}">
          <aero10:TextBoxChrome Style="{StaticResource {x:Type aero10:TextBoxChrome}}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Foreground="{TemplateBinding Foreground}"
                                RenderEnabled="{TemplateBinding IsEnabled}"
                                RenderReadOnly="{TemplateBinding IsReadOnly}"
                                RenderFocused="{TemplateBinding IsKeyboardFocused}"
                                RenderHot="{TemplateBinding IsMouseOver}">
            <ScrollViewer x:Name="PART_ContentHost"
                          Focusable="False"
                          HorizontalScrollBarVisibility="Hidden"
                          VerticalScrollBarVisibility="Hidden"/>
          </aero10:TextBoxChrome>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsInactiveSelectionHighlightEnabled" Value="True"/>
          <Condition Property="IsSelectionActive" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="SelectionBrush" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="{x:Type PasswordBox}" TargetType="{x:Type PasswordBox}">
    <Setter Property="PasswordChar" Value="●"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource TextBox.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource TextBox.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Padding" Value="-1,2"/>
    <Setter Property="KeyboardNavigation.TabNavigation" Value="None"/>
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
    <Setter Property="AllowDrop" Value="True"/>
    <Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type PasswordBox}">
          <aero10:TextBoxChrome Style="{StaticResource {x:Type aero10:TextBoxChrome}}"
                                Focusable="False"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Foreground="{TemplateBinding Foreground}"
                                RenderEnabled="{TemplateBinding IsEnabled}"
                                RenderFocused="{TemplateBinding IsKeyboardFocused}"
                                RenderHot="{TemplateBinding IsMouseOver}">
            <ScrollViewer x:Name="PART_ContentHost"
                          Focusable="False"
                          HorizontalScrollBarVisibility="Hidden"
                          VerticalScrollBarVisibility="Hidden"/>
          </aero10:TextBoxChrome>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsInactiveSelectionHighlightEnabled" Value="True"/>
          <Condition Property="IsSelectionActive" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="SelectionBrush" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="{x:Type TextBox}" TargetType="{x:Type TextBox}"
         BasedOn="{StaticResource {x:Type TextBoxBase}}"/>

  <Style x:Key="{x:Type RichTextBox}" TargetType="{x:Type RichTextBox}"
           BasedOn="{StaticResource {x:Type TextBoxBase}}">
    <Style.Resources>
      <Style x:Key="{x:Type FlowDocument}" TargetType="{x:Type FlowDocument}">
        <Setter Property="OverridesDefaultStyle" Value="True"/>
      </Style>
      <Style x:Key="{x:Type Hyperlink}" TargetType="{x:Type Hyperlink}"
             BasedOn="{StaticResource {x:Type Hyperlink}}">
        <Style.Triggers>
          <Trigger Property="IsMouseOver" Value="True">
            <Setter Property="Foreground" Value="Blue"/>
          </Trigger>
          <Trigger Property="IsEnabled" Value="False">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
          </Trigger>
        </Style.Triggers>
      </Style>
    </Style.Resources>
    <Setter Property="MinWidth" Value="10"/>
  </Style>


  <!-- Button ============================================================== -->

  <Style x:Key="Button.FocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Border Margin="{Binding AdornedElement.BorderThickness, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Adorner}}}">
            <Rectangle Margin="2"
                       SnapsToDevicePixels="True"
                       Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                       StrokeThickness="1"
                       StrokeDashArray="1 1"
                       StrokeDashOffset="1.5"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style TargetType="{x:Type aero10:ButtonChrome}">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Margin" Value="1"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type aero10:ButtonChrome}">
          <Border x:Name="Border"
                  Background="{TemplateBinding Background}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  SnapsToDevicePixels="True">
            <VisualStateManager.VisualStateGroups>
              <VisualStateGroup x:Name="Common">
                <VisualState x:Name="Normal"/>
                <VisualState x:Name="Hot">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Border.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Background.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Foreground.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Pressed">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Border.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Background.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Defaulted">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Border.Defaulted.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Background.Defaulted.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Foreground.Defaulted.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Disabled">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Border.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource Button.Background.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
              </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <ContentPresenter x:Name="Content"
                              RecognizesAccessKey="True"
                              Margin="{TemplateBinding Padding}"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                              Focusable="False"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="BaseButtonStyle" TargetType="{x:Type ButtonBase}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource Button.FocusVisual}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource Button.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Button.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="MinWidth" Value="10"/>
    <Setter Property="MinHeight" Value="5"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ButtonBase}">
          <aero10:ButtonChrome Style="{StaticResource {x:Type aero10:ButtonChrome}}"
                               Focusable="False"
                               Background="{TemplateBinding Background}"
                               BorderBrush="{TemplateBinding BorderBrush}"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               Foreground="{TemplateBinding Foreground}"
                               Padding="{TemplateBinding Padding}"
                               RenderEnabled="{TemplateBinding IsEnabled}"
                               RenderPressed="{TemplateBinding IsPressed}"
                               RenderFocused="{TemplateBinding IsKeyboardFocused}"
                               RenderHot="{Binding IsMouseOver, RelativeSource={RelativeSource TemplatedParent}}"
                               Content="{TemplateBinding Content}"
                               ContentStringFormat="{TemplateBinding ContentStringFormat}"
                               ContentTemplate="{TemplateBinding ContentTemplate}"
                               ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="TextElement.Foreground" Value="{aero10:SystemAliasResource Button.Foreground.Disabled}"/>
      </Trigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="ButtonStyle" TargetType="{x:Type Button}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource Button.FocusVisual}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource Button.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Button.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="MinWidth" Value="10"/>
    <Setter Property="MinHeight" Value="5"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Button}">
          <aero10:ButtonChrome Style="{StaticResource {x:Type aero10:ButtonChrome}}"
                               Focusable="False"
                               Background="{TemplateBinding Background}"
                               BorderBrush="{TemplateBinding BorderBrush}"
                               BorderThickness="{TemplateBinding BorderThickness}"
                               Foreground="{TemplateBinding Foreground}"
                               Padding="{TemplateBinding Padding}"
                               RenderEnabled="{TemplateBinding IsEnabled}"
                               RenderPressed="{TemplateBinding IsPressed}"
                               RenderFocused="{TemplateBinding IsKeyboardFocused}"
                               RenderDefaulted="{TemplateBinding IsDefaulted}"
                               RenderHot="{Binding IsMouseOver, RelativeSource={RelativeSource TemplatedParent}}"
                               Content="{TemplateBinding Content}"
                               ContentStringFormat="{TemplateBinding ContentStringFormat}"
                               ContentTemplate="{TemplateBinding ContentTemplate}"
                               ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="TextElement.Foreground" Value="{aero10:SystemAliasResource Button.Foreground.Disabled}"/>
      </Trigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="{x:Type ToggleButton}" TargetType="{x:Type ToggleButton}"
         BasedOn="{StaticResource BaseButtonStyle}"/>

  <Style x:Key="{x:Type RepeatButton}" TargetType="{x:Type RepeatButton}"
         BasedOn="{StaticResource BaseButtonStyle}">
    <Setter Property="Stylus.IsPressAndHoldEnabled" Value="False"/>
  </Style>

  <Style x:Key="{x:Type Button}" TargetType="{x:Type Button}"
         BasedOn="{StaticResource ButtonStyle}"/>


  <!-- CheckBox ============================================================ -->

  <Style x:Key="OptionMarkEmptyFocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Rectangle Width="15" Height="15" Margin="-2,-3,-2,-1"
                     SnapsToDevicePixels="True"
                     Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                     StrokeThickness="1"
                     StrokeDashArray="1 1"
                     StrokeDashOffset="1.5"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="OptionMarkFocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Border Margin="{Binding AdornedElement.Padding, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Adorner}}}">
            <Rectangle Margin="15,1,1,2"
                       SnapsToDevicePixels="True"
                       Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                       StrokeThickness="1"
                       StrokeDashArray="1 1"
                       StrokeDashOffset="1.5"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Geometry x:Key="Checkbox.CheckMark">
    F1 M0.86,5.88 2.699,4.182 5.699,7.432 4.78,8.28 3.804,7.499 8.804,1.249 10.756,2.811 4.848,10.196 3.861,9.128 0.861,5.878 z
  </Geometry>

  <Geometry x:Key="Checkbox.IndeterminateMark">
    F1 M0,0 5,0 5,5 0,5 z
  </Geometry>

  <Style TargetType="{x:Type CheckBox}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource OptionMarkEmptyFocusVisual}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="HorizontalAlignment" Value="Left"/>
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type CheckBox}">
          <Grid SnapsToDevicePixels="True" Background="Transparent">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Border x:Name="Border"
                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}">
              <Grid Width="11" Height="11">
                <Path x:Name="Mark" Stretch="None" Fill="{aero10:SystemAliasResource CheckBox.Mark.Normal}"/>
              </Grid>
            </Border>
            <ContentPresenter x:Name="Content"
                              RecognizesAccessKey="True"
                              Grid.Column="1"
                              Margin="0"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                              Focusable="False"/>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Hot}"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Hot}"/>
              <Setter TargetName="Mark" Property="Fill" Value="{aero10:SystemAliasResource CheckBox.Mark.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Pressed}"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Pressed}"/>
              <Setter TargetName="Mark" Property="Fill" Value="{aero10:SystemAliasResource CheckBox.Mark.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Disabled}"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Disabled}"/>
              <Setter TargetName="Mark" Property="Fill" Value="{aero10:SystemAliasResource CheckBox.Mark.Disabled}"/>
            </Trigger>
            <Trigger Property="HasContent" Value="True">
              <Setter Property="FocusVisualStyle" Value="{StaticResource OptionMarkFocusVisual}"/>
              <Setter TargetName="Content" Property="Margin" Value="3,2,2,3"/>
            </Trigger>
            <Trigger Property="TextOptions.TextFormattingMode" Value="Display">
              <Setter TargetName="Border" Property="Margin" Value="0,-1,0,0"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="Mark" Property="Data" Value="{StaticResource Checkbox.CheckMark}"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="{x:Null}">
              <Setter TargetName="Mark" Property="Data" Value="{StaticResource Checkbox.IndeterminateMark}"/>
              <Setter TargetName="Mark" Property="Margin" Value="3"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
    </Style.Triggers>
  </Style>


  <!-- RadioButton ========================================================= -->

  <Style TargetType="{x:Type RadioButton}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource OptionMarkEmptyFocusVisual}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="HorizontalAlignment" Value="Left"/>
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RadioButton}">
          <Grid SnapsToDevicePixels="True" Background="Transparent">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Border x:Name="Border"
                    Width="12"
                    Height="12"
                    Margin="0,0,1,1"
                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    CornerRadius="100">
              <Ellipse x:Name="OptionMark" Margin="2" MinWidth="6" MinHeight="6"
                       Opacity="0" Fill="{aero10:SystemAliasResource CheckBox.Mark.Normal}"/>
            </Border>
            <ContentPresenter x:Name="Content"
                              RecognizesAccessKey="True"
                              Grid.Column="1"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                              Focusable="False"/>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Hot}"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Hot}"/>
              <Setter TargetName="OptionMark" Property="Fill" Value="{aero10:SystemAliasResource CheckBox.Mark.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Pressed}"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Pressed}"/>
              <Setter TargetName="OptionMark" Property="Fill" Value="{aero10:SystemAliasResource CheckBox.Mark.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource CheckBox.Border.Disabled}"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource CheckBox.Background.Disabled}"/>
              <Setter TargetName="OptionMark" Property="Fill" Value="{aero10:SystemAliasResource CheckBox.Mark.Disabled}"/>
            </Trigger>
            <Trigger Property="HasContent" Value="True">
              <Setter Property="FocusVisualStyle" Value="{StaticResource OptionMarkFocusVisual}"/>
              <Setter TargetName="Content" Property="Margin" Value="3,2,2,3"/>
            </Trigger>
            <Trigger Property="TextOptions.TextFormattingMode" Value="Display">
              <Setter TargetName="Border" Property="Margin" Value="0,-1,1,1"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="OptionMark" Property="Opacity" Value="1"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="{x:Null}">
              <Setter TargetName="OptionMark" Property="Opacity" Value="0.56"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
    </Style.Triggers>
  </Style>


  <!-- ComboBox ============================================================ -->

  <Geometry x:Key="ComboBox.Glyph">M0,3 0,0 3.5,3.5 7,0 7,3 3.5,6.5 z</Geometry>

  <Style x:Key="ComboBox.ReadOnly.FocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Border Margin="{Binding AdornedElement.BorderThickness, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Adorner}}}">
            <Rectangle Margin="2,2,19,2"
                       SnapsToDevicePixels="True"
                       Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                       StrokeThickness="1"
                       StrokeDashArray="1 1"
                       StrokeDashOffset="1.5"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ComboBox.ReadOnly.Button" TargetType="{x:Type ToggleButton}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="ClickMode" Value="Press"/>
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border x:Name="Border"
                  Background="{TemplateBinding Background}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  SnapsToDevicePixels="True">
            <VisualStateManager.VisualStateGroups>
              <VisualStateGroup x:Name="CommonStates">
                <VisualState x:Name="Normal"/>
                <VisualState x:Name="MouseOver">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Pressed">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Checked">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Disabled">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="DropDownBorder"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="DropDownBorder"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
              </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="0"
                                  MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
              </Grid.ColumnDefinitions>
              <Border x:Name="DropDownBorder"
                      Grid.Column="1"
                      HorizontalAlignment="Right"
                      Margin="{Binding BorderThickness, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource InvertThicknessConverter}}"
                      Background="{TemplateBinding Background}"
                      BorderThickness="{TemplateBinding BorderThickness}"
                      BorderBrush="{TemplateBinding BorderBrush}"
                      SnapsToDevicePixels="True">
                <Border HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Margin="2,1,3,1"
                        Width="10"
                        Height="19">
                  <Path x:Name="Glyph"
                        Fill="{aero10:SystemAliasResource ComboBox.Glyph.Normal}"
                        Data="{StaticResource ComboBox.Glyph}"
                        Stretch="Uniform"
                        Margin="2,6,1,6"
                        Width="7"
                        Height="7"
                        RenderOptions.EdgeMode="Aliased"
                        UseLayoutRounding="False"/>
                </Border>
              </Border>
              <ContentPresenter x:Name="Content"
                                Content="{TemplateBinding Content}"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"
                                ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                IsHitTestVisible="False"
                                Margin="{TemplateBinding Padding}"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
            </Grid>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ComboBox.Editable.TextBox" TargetType="{x:Type TextBox}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="AllowDrop" Value="True"/>
    <Setter Property="MinWidth" Value="0"/>
    <Setter Property="MinHeight" Value="0"/>
    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
    <Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="aero:TextBoxService.ViewMargin" Value="0"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type TextBox}">
          <ScrollViewer x:Name="PART_ContentHost"
                        Focusable="False"
                        HorizontalScrollBarVisibility="Hidden"
                        VerticalScrollBarVisibility="Hidden"
                        Background="Transparent"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ComboBox.Editable.DropDownButton" TargetType="{x:Type ToggleButton}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource ComboBox.DropDownButton.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ComboBox.DropDownButton.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="ClickMode" Value="Press"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border x:Name="Border"
                  Background="{TemplateBinding Background}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  SnapsToDevicePixels="True">
            <VisualStateManager.VisualStateGroups>
              <VisualStateGroup x:Name="CommonStates">
                <VisualState x:Name="Normal"/>
                <VisualState x:Name="MouseOver">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Hot.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Pressed">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Checked">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Pressed.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
                <VisualState x:Name="Disabled">
                  <Storyboard>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="BorderBrush.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                  Storyboard.TargetProperty="Background.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="Glyph"
                                                  Storyboard.TargetProperty="Fill.(SolidColorBrush.Color)">
                      <DiscreteColorKeyFrame KeyTime="0" Value="{aero10:SystemAliasResource ComboBox.Glyph.Disabled.Color}"/>
                    </ColorAnimationUsingKeyFrames>
                  </Storyboard>
                </VisualState>
              </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
            <Border HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Margin="1,1,3,1"
                    Width="10"
                    Height="19">
              <Path x:Name="Glyph"
                    Fill="{aero10:SystemAliasResource ComboBox.Glyph.Normal}"
                    Data="{StaticResource ComboBox.Glyph}"
                    Width="7"
                    Height="7"
                    Margin="2,6,1,6"
                    Stretch="Uniform"
                    RenderOptions.EdgeMode="Aliased"
                    UseLayoutRounding="False"/>
            </Border>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <ControlTemplate x:Key="ComboBox.Template.ReadOnly" TargetType="{x:Type ComboBox}">
    <Grid x:Name="TemplateRoot" SnapsToDevicePixels="True">
      <Popup x:Name="PART_Popup"
             AllowsTransparency="True"
             Margin="1"
             Placement="Bottom"
             IsOpen="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
             PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
        <aero10:SystemDropShadowChrome x:Name="Shadow"
                                       Color="Transparent"
                                       MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                       MinWidth="{Binding ActualWidth, ElementName=TemplateRoot}">
          <Border x:Name="DropDownBorder"
                  BorderBrush="{DynamicResource {x:Static SystemColors.WindowFrameBrushKey}}"
                  Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}"
                  BorderThickness="1">
            <ScrollViewer x:Name="DropDownScrollViewer">
              <Grid x:Name="Grid" RenderOptions.ClearTypeHint="Enabled">
                <Canvas x:Name="Canvas"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Height="0"
                        Width="0">
                  <Rectangle x:Name="OpaqueRect"
                             Fill="{Binding Background, ElementName=DropDownBorder}"
                             Height="{Binding ActualHeight, ElementName=DropDownBorder}"
                             Width="{Binding ActualWidth, ElementName=DropDownBorder}"/>
                </Canvas>
                <ItemsPresenter x:Name="ItemsPresenter"
                                KeyboardNavigation.DirectionalNavigation="Contained"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
              </Grid>
            </ScrollViewer>
          </Border>
        </aero10:SystemDropShadowChrome>
      </Popup>
      <ToggleButton x:Name="ToggleButton"
                    Style="{StaticResource ComboBox.ReadOnly.Button}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    Background="{TemplateBinding Background}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Foreground="{TemplateBinding Foreground}"
                    IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                    Content="{TemplateBinding SelectionBoxItem}"
                    ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                    ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                    ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                    HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                    VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                    Padding="{TemplateBinding Padding}"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
      <Trigger Property="HasDropShadow" SourceName="PART_Popup" Value="True">
        <Setter TargetName="Shadow" Property="Margin" Value="0,0,5,5"/>
        <Setter TargetName="Shadow" Property="Color" Value="#71000000"/>
      </Trigger>
      <Trigger Property="HasItems" Value="False">
        <Setter TargetName="DropDownBorder" Property="Height" Value="95"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsGrouping" Value="True"/>
          <Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="ScrollViewer.CanContentScroll" Value="False"/>
      </MultiTrigger>
      <Trigger SourceName="DropDownScrollViewer" Property="ScrollViewer.CanContentScroll" Value="False">
        <Setter TargetName="OpaqueRect" Property="Canvas.Left" Value="{Binding HorizontalOffset, ElementName=DropDownScrollViewer}"/>
        <Setter TargetName="OpaqueRect" Property="Canvas.Top" Value="{Binding VerticalOffset, ElementName=DropDownScrollViewer}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="ComboBox.Template.Editable" TargetType="{x:Type ComboBox}">
    <Grid x:Name="TemplateRoot" SnapsToDevicePixels="True">
      <Popup x:Name="PART_Popup"
             AllowsTransparency="True"
             Placement="Bottom"
             IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
             PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
        <aero10:SystemDropShadowChrome x:Name="Shadow"
                                       Color="Transparent"
                                       MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                       MinWidth="{Binding ActualWidth, ElementName=TemplateRoot}">
          <Border x:Name="DropDownBorder"
                  BorderBrush="{aero10:SystemAliasResource ComboBox.ListBox.Border.Hot}"
                  Background="{aero10:SystemAliasResource ComboBox.ListBox.Background.Hot}"
                  BorderThickness="1">
            <ScrollViewer x:Name="DropDownScrollViewer">
              <Grid x:Name="Grid" RenderOptions.ClearTypeHint="Enabled">
                <Canvas x:Name="Canvas"
                        HorizontalAlignment="Left"
                        VerticalAlignment="Top"
                        Width="0"
                        Height="0">
                  <Rectangle x:Name="OpaqueRect"
                             Fill="{Binding Background, ElementName=DropDownBorder}"
                             Height="{Binding ActualHeight, ElementName=DropDownBorder}"
                             Width="{Binding ActualWidth, ElementName=DropDownBorder}"/>
                </Canvas>
                <ItemsPresenter x:Name="ItemsPresenter"
                                KeyboardNavigation.DirectionalNavigation="Contained"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
              </Grid>
            </ScrollViewer>
          </Border>
        </aero10:SystemDropShadowChrome>
      </Popup>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"
                            MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
        </Grid.ColumnDefinitions>
        <aero10:TextBoxChrome Grid.ColumnSpan="2"
                              Style="{StaticResource {x:Type aero10:TextBoxChrome}}"
                              Focusable="False"
                              Background="{TemplateBinding Background}"
                              BorderBrush="{TemplateBinding BorderBrush}"
                              BorderThickness="{TemplateBinding BorderThickness}"
                              Foreground="{TemplateBinding Foreground}"
                              RenderEnabled="{TemplateBinding IsEnabled}"
                              RenderReadOnly="{TemplateBinding IsReadOnly}"
                              RenderFocused="{Binding IsKeyboardFocused, ElementName=PART_EditableTextBox}"
                              RenderHot="{TemplateBinding IsMouseOver}"/>
        <Border Margin="{TemplateBinding BorderThickness}">
          <TextBox x:Name="PART_EditableTextBox"
                   Style="{StaticResource ComboBox.Editable.TextBox}"
                   IsReadOnly="{Binding IsReadOnly, RelativeSource={RelativeSource TemplatedParent}}"
                   Padding="{TemplateBinding Padding}"
                   HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                   VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
        </Border>
        <ToggleButton x:Name="ToggleButton"
                      Grid.Column="1"
                      IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                      Style="{StaticResource ComboBox.Editable.DropDownButton}"
                      BorderThickness="{TemplateBinding BorderThickness}"
                      HorizontalContentAlignment="Center"/>
      </Grid>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
      <Trigger Property="IsKeyboardFocusWithin" Value="True">
        <Setter Property="Foreground" Value="Black"/>
      </Trigger>
      <Trigger Property="HasDropShadow" SourceName="PART_Popup" Value="True">
        <Setter TargetName="Shadow" Property="Margin" Value="0,0,5,5"/>
        <Setter TargetName="Shadow" Property="Color" Value="#71000000"/>
      </Trigger>
      <Trigger Property="HasItems" Value="False">
        <Setter TargetName="DropDownBorder" Property="Height" Value="95"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsGrouping" Value="True"/>
          <Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="ScrollViewer.CanContentScroll" Value="False"/>
      </MultiTrigger>
      <Trigger Property="ScrollViewer.CanContentScroll" SourceName="DropDownScrollViewer" Value="False">
        <Setter TargetName="OpaqueRect" Property="Canvas.Top" Value="{Binding VerticalOffset, ElementName=DropDownScrollViewer}"/>
        <Setter TargetName="OpaqueRect" Property="Canvas.Left" Value="{Binding HorizontalOffset, ElementName=DropDownScrollViewer}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <Style TargetType="{x:Type ComboBox}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource ComboBox.ReadOnly.FocusVisual}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource ComboBox.Button.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ComboBox.Button.Border.Normal}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Padding" Value="3,2,2,2"/>
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="Template" Value="{StaticResource ComboBox.Template.ReadOnly}"/>
    <Style.Triggers>
      <Trigger Property="IsEditable" Value="True">
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Template" Value="{StaticResource ComboBox.Template.Editable}"/>
        <Setter Property="Background" Value="{aero10:SystemAliasResource ComboBox.Editable.Background.Normal}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ComboBox.Editable.Border.Normal}"/>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
        <Setter Property="Padding" Value="2"/>
      </Trigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="ComboBoxItem.HighlightFocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Rectangle SnapsToDevicePixels="True"
                     Stroke="#FFCC6600"
                     StrokeThickness="1"
                     StrokeDashArray="1 1"
                     StrokeDashOffset="1.5"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style TargetType="{x:Type ComboBoxItem}">
    <Setter Property="SnapsToDevicePixels" Value="True"/>
    <Setter Property="Padding" Value="2,0"/>
    <Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="FocusVisualStyle" Value="{StaticResource ComboBoxItem.HighlightFocusVisual}"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ComboBoxItem}">
          <Border x:Name="Bd"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Background="{TemplateBinding Background}"
                  Padding="{TemplateBinding Padding}"
                  SnapsToDevicePixels="True">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="TextElement.Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelected" Value="True"/>
          <Condition Property="IsMouseOver" Value="False"/>
          <Condition Property="UIElement.IsKeyboardFocused" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelected" Value="False"/>
          <Condition Property="IsMouseOver" Value="False"/>
          <Condition Property="UIElement.IsKeyboardFocused" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
      </MultiTrigger>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
      </Trigger>
    </Style.Triggers>
  </Style>


  <!-- ListBox ============================================================= -->

  <Style x:Key="{x:Type ListBox}" TargetType="{x:Type ListBox}">
    <Setter Property="Background" Value="{aero10:SystemAliasResource ListBox.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ListBox.Border.Normal}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ListBox}">
          <Border x:Name="Border"
                  Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  SnapsToDevicePixels="True"
                  Padding="{TemplateBinding Padding}">
            <ScrollViewer Focusable="False">
              <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </ScrollViewer>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Background" Value="{aero10:SystemAliasResource ListBox.Background.Disabled}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ListBox.Border.Disabled}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsGrouping" Value="True"/>
          <Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="ScrollViewer.CanContentScroll" Value="False"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="ListBoxItem.FocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Rectangle SnapsToDevicePixels="True"
                     Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                     StrokeThickness="1"
                     StrokeDashArray="1 1"
                     StrokeDashOffset="1.5"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ListBoxItem.HighlightFocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Rectangle SnapsToDevicePixels="True"
                     Stroke="#FFCC6600"
                     StrokeThickness="1"
                     StrokeDashArray="1 1"
                     StrokeDashOffset="1.5"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{x:Type ListBoxItem}" TargetType="{x:Type ListBoxItem}">
    <Setter Property="SnapsToDevicePixels" Value="True"/>
    <Setter Property="Padding" Value="2,0"/>
    <Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="FocusVisualStyle" Value="{StaticResource ListBoxItem.FocusVisual}"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ListBoxItem}">
          <Border BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Background="{TemplateBinding Background}"
                  Padding="{TemplateBinding Padding}"
                  SnapsToDevicePixels="True">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Selector.IsSelectionActive" Value="True"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="FocusVisualStyle" Value="{StaticResource ListBoxItem.HighlightFocusVisual}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Selector.IsSelectionActive" Value="False"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
      </MultiTrigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="TextElement.Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
    </Style.Triggers>
  </Style>


  <!-- ListView ============================================================ -->

  <Style x:Key="GridViewColumnHeaderGripper" TargetType="{x:Type Thumb}">
    <Setter Property="Canvas.Right" Value="-9"/>
    <Setter Property="Width" Value="18"/>
    <Setter Property="Height"
            Value="{Binding ActualHeight, RelativeSource={RelativeSource TemplatedParent}}"/>
    <Setter Property="Padding" Value="0"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Thumb}">
          <Border Background="Transparent"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="GridViewColumnHeader" TargetType="{x:Type GridViewColumnHeader}">
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Background" Value="{x:Null}"/>
    <Setter Property="BorderBrush" Value="{x:Null}"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="Padding" Value="6,2,6,2"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
          <Grid SnapsToDevicePixels="True">
            <Border x:Name="HeaderBorder"
                    Padding="{TemplateBinding Padding}"
                    Background="{aero10:SystemAliasResource Header.Background.Normal}"
                    BorderBrush="{aero10:SystemAliasResource Header.Border.Normal}"
                    BorderThickness="1"/>
            <Border Padding="{TemplateBinding Padding}">
              <ContentPresenter x:Name="HeaderContent"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                RecognizesAccessKey="True"/>
            </Border>
            <Canvas>
              <Thumb x:Name="PART_HeaderGripper"
                     Style="{StaticResource GridViewColumnHeaderGripper}"/>
            </Canvas>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="PART_HeaderGripper" Property="Visibility" Value="Hidden"/>
              <Setter TargetName="HeaderBorder" Property="Background"
                      Value="{aero10:SystemAliasResource Header.Background.Pressed}"/>
              <Setter TargetName="HeaderBorder" Property="BorderBrush"
                      Value="{aero10:SystemAliasResource Header.Border.Pressed}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="PART_HeaderGripper" Property="Background" Value="Transparent"/>
              <Setter TargetName="HeaderBorder" Property="Background"
                      Value="{aero10:SystemAliasResource Header.Background.Hot}"/>
              <Setter TargetName="HeaderBorder" Property="BorderBrush"
                      Value="{aero10:SystemAliasResource Header.Border.Hot}"/>
            </Trigger>
            <Trigger Property="Height" Value="Auto">
              <Setter Property="MinHeight" Value="19"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter Property="Foreground"
                      Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="Role" Value="Floating">
        <Setter Property="Opacity" Value="0.408"/>
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
              <Canvas x:Name="PART_FloatingHeaderCanvas">
                <Rectangle Width="{TemplateBinding ActualWidth}"
                           Height="{TemplateBinding ActualHeight}"
                           Fill="#FF000000"
                           Opacity="0.469"/>
              </Canvas>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Trigger>
      <Trigger Property="Role" Value="Padding">
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type GridViewColumnHeader}">
              <Border x:Name="HeaderBorder"
                      Background="{aero10:SystemAliasResource Header.Background.Normal}"
                      BorderBrush="{aero10:SystemAliasResource Header.Border.Normal}"
                      BorderThickness="0,0,0,1"/>
              <ControlTemplate.Triggers>
                <Trigger Property="Height" Value="Auto">
                  <Setter Property="MinHeight" Value="19"/>
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Trigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="GridViewItemStyle" TargetType="{x:Type ListViewItem}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource ListBoxItem.FocusVisual}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="0"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
    <Setter Property="Margin" Value="0"/>
    <Setter Property="Padding" Value="0,2"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ListViewItem}">
          <Border BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Background="{TemplateBinding Background}"
                  Padding="{TemplateBinding Padding}"
                  SnapsToDevicePixels="True"
                  HorizontalAlignment="Left">
            <GridViewRowPresenter
              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Selector.IsSelectionActive" Value="True"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="FocusVisualStyle" Value="{StaticResource ListBoxItem.HighlightFocusVisual}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="Selector.IsSelectionActive" Value="False"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
        <Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
      </MultiTrigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
      <Trigger Property="aero:ThemeOptions.UseExplorerStyle" Value="True">
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type ListViewItem}">
              <Border BorderBrush="{TemplateBinding BorderBrush}"
                      BorderThickness="{TemplateBinding BorderThickness}"
                      Background="{TemplateBinding Background}"
                      Padding="{TemplateBinding Padding}"
                      SnapsToDevicePixels="True"
                      HorizontalAlignment="Left">
                <!-- Use a negative margin on the row presenter instead of a
                     reduced padding on the border to be able to use the same
                     padding values for explorer and non-explorer style. -->
                <GridViewRowPresenter
                  Margin="-1"
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
              </Border>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="aero:ThemeOptions.UseExplorerStyle" Value="True"/>
          <Condition Property="IsMouseOver" Value="True"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Background" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Background.HotSelected}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Border.HotSelected}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Foreground.HotSelected}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="aero:ThemeOptions.UseExplorerStyle" Value="True"/>
          <Condition Property="IsMouseOver" Value="True"/>
          <Condition Property="IsSelected" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="Background" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Background.Hot}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Border.Hot}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Foreground.Hot}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="aero:ThemeOptions.UseExplorerStyle" Value="True"/>
          <Condition Property="IsMouseOver" Value="False"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Background" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Background.Selected}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Border.Selected}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Foreground.Selected}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="aero:ThemeOptions.UseExplorerStyle" Value="True"/>
          <Condition Property="IsSelected" Value="True"/>
          <Condition Property="Selector.IsSelectionActive" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="Background" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Background.SelectedNotFocus}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Border.SelectedNotFocus}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Foreground.SelectedNotFocus}"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>

  <Style x:Key="GridViewScrollViewer" TargetType="{x:Type ScrollViewer}">
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ScrollViewer}">
          <Grid Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="*"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <DockPanel Margin="{TemplateBinding Padding}">
              <ScrollViewer DockPanel.Dock="Top"
                            Focusable="False"
                            HorizontalScrollBarVisibility="Hidden"
                            VerticalScrollBarVisibility="Hidden">
                <GridViewHeaderRowPresenter
                  AllowsColumnReorder="{Binding TemplatedParent.View.AllowsColumnReorder, RelativeSource={RelativeSource TemplatedParent}}"
                  ColumnHeaderContainerStyle="{StaticResource GridViewColumnHeader}"
                  ColumnHeaderContextMenu="{Binding TemplatedParent.View.ColumnHeaderContextMenu, RelativeSource={RelativeSource TemplatedParent}}"
                  ColumnHeaderStringFormat="{Binding TemplatedParent.View.ColumnHeaderStringFormat, RelativeSource={RelativeSource TemplatedParent}}"
                  ColumnHeaderTemplate="{Binding TemplatedParent.View.ColumnHeaderTemplate, RelativeSource={RelativeSource TemplatedParent}}"
                  ColumnHeaderTemplateSelector="{Binding TemplatedParent.View.ColumnHeaderTemplateSelector, RelativeSource={RelativeSource TemplatedParent}}"
                  ColumnHeaderToolTip="{Binding TemplatedParent.View.ColumnHeaderToolTip, RelativeSource={RelativeSource TemplatedParent}}"
                  Columns="{Binding TemplatedParent.View.Columns, RelativeSource={RelativeSource TemplatedParent}}"
                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
              </ScrollViewer>
              <ScrollContentPresenter
                x:Name="PART_ScrollContentPresenter"
                CanContentScroll="{TemplateBinding CanContentScroll}"
                Content="{TemplateBinding Content}"
                ContentTemplate="{TemplateBinding ContentTemplate}"
                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                KeyboardNavigation.DirectionalNavigation="Local"/>
            </DockPanel>
            <ScrollBar x:Name="PART_HorizontalScrollBar"
                       Grid.Row="1"
                       Cursor="Arrow"
                       Margin="0"
                       Minimum="0.0"
                       Maximum="{TemplateBinding ScrollableWidth}"
                       Orientation="Horizontal"
                       Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                       ViewportSize="{TemplateBinding ViewportWidth}"
                       Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
            <ScrollBar x:Name="PART_VerticalScrollBar"
                       Grid.Column="1"
                       Cursor="Arrow"
                       Margin="0"
                       Minimum="0.0"
                       Maximum="{TemplateBinding ScrollableHeight}"
                       Orientation="Vertical"
                       Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                       ViewportSize="{TemplateBinding ViewportHeight}"
                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
            <DockPanel Grid.Column="1" Grid.Row="1"
                       Background="{Binding Background, ElementName=PART_VerticalScrollBar}"
                       LastChildFill="False"/>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <ControlTemplate x:Key="GridViewTemplate" TargetType="{x:Type ListView}">
    <Border Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            Padding="{TemplateBinding Padding}"
            SnapsToDevicePixels="True">
      <ScrollViewer Style="{StaticResource GridViewScrollViewer}">
        <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
      </ScrollViewer>
    </Border>
    <ControlTemplate.Triggers>
      <Trigger Property="IsGrouping" Value="True">
        <Setter Property="ScrollViewer.CanContentScroll" Value="False"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <Style x:Key="{x:Static GridView.GridViewItemContainerStyleKey}" TargetType="{x:Type ListViewItem}"
         BasedOn="{StaticResource GridViewItemStyle}"/>

  <Style x:Key="{x:Static GridView.GridViewStyleKey}" TargetType="{x:Type ListView}">
    <Setter Property="Background" Value="{aero10:SystemAliasResource ListView.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ListView.Border.Normal}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template" Value="{StaticResource GridViewTemplate}"/>
    <Style.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Background" Value="{aero10:SystemAliasResource ListView.Background.Disabled}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ListView.Border.Disabled}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsGrouping" Value="True"/>
          <Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter Property="ScrollViewer.CanContentScroll" Value="False"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>


  <!-- Menu ================================================================ -->

  <MenuScrollingVisibilityConverter x:Key="MenuScrollingVisibilityConverter"/>
  <Geometry x:Key="Menu.DownArrowGlyph">M 0,0 3.5,4 7,0 z</Geometry>
  <Geometry x:Key="Menu.UpArrowGlyph">M 0,4 3.5,0 7,4 z</Geometry>
  <Geometry x:Key="Menu.PopupSubmenu.Glyph">M 0,-0.5 3.5,3 0,6.5 -0.5,6 2.5,3 -0.5,0 z</Geometry>
  <Geometry x:Key="Menu.CheckmarkGlyph">F1 M 3.5,7 7.5,13 12.5,3 12,1.5 7.5,9 5.5,7 z</Geometry>

  <ControlTemplate x:Key="{ComponentResourceKey {x:Type FrameworkElement}, SubmenuContent}"
                   TargetType="{x:Type ContentControl}">
    <Border Background="{TemplateBinding Menu.Background}"
            BorderBrush="{TemplateBinding Menu.BorderBrush}"
            BorderThickness="1"
            Padding="2">
      <Border Background="{aero10:SystemAliasResource Menu.Popup.Background}">
        <ContentPresenter/>
      </Border>
    </Border>
  </ControlTemplate>

  <Style x:Key="MenuScrollButton" TargetType="{x:Type RepeatButton}" BasedOn="{x:Null}">
    <Setter Property="ClickMode" Value="Hover"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RepeatButton}">
          <Border x:Name="TemplateRoot"
                  SnapsToDevicePixels="True"
                  Background="Transparent"
                  BorderBrush="Transparent"
                  BorderThickness="1">
            <ContentPresenter Margin="6"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{ComponentResourceKey {x:Type FrameworkElement}, MenuScrollViewer}"
         TargetType="{x:Type ScrollViewer}" BasedOn="{x:Null}">
    <Setter Property="HorizontalScrollBarVisibility" Value="Hidden"/>
    <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ScrollViewer}">
          <Grid SnapsToDevicePixels="True">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
              <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Border Grid.Row="1">
              <ScrollContentPresenter
                Margin="{TemplateBinding Padding}"
                CanContentScroll="{TemplateBinding CanContentScroll}"/>
            </Border>
            <RepeatButton Style="{StaticResource MenuScrollButton}"
                          Command="{x:Static ScrollBar.LineUpCommand}"
                          CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                          Focusable="False">
              <RepeatButton.Visibility>
                <MultiBinding ConverterParameter="0"
                              Converter="{StaticResource MenuScrollingVisibilityConverter}"
                              FallbackValue="Visibility.Collapsed">
                  <Binding Path="ComputedVerticalScrollBarVisibility"
                           RelativeSource="{RelativeSource TemplatedParent}"/>
                  <Binding Path="VerticalOffset" RelativeSource="{RelativeSource TemplatedParent}"/>
                  <Binding Path="ExtentHeight" RelativeSource="{RelativeSource TemplatedParent}"/>
                  <Binding Path="ViewportHeight" RelativeSource="{RelativeSource TemplatedParent}"/>
                </MultiBinding>
              </RepeatButton.Visibility>
              <Path Data="{StaticResource Menu.UpArrowGlyph}"
                    Fill="{aero10:SystemAliasResource Menu.PopupItem.Normal.Foreground}"/>
            </RepeatButton>
            <RepeatButton Grid.Row="2"
                          Style="{StaticResource MenuScrollButton}"
                          Command="{x:Static ScrollBar.LineDownCommand}"
                          CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                          Focusable="False">
              <RepeatButton.Visibility>
                <MultiBinding ConverterParameter="100"
                              Converter="{StaticResource MenuScrollingVisibilityConverter}"
                              FallbackValue="Visibility.Collapsed">
                  <Binding Path="ComputedVerticalScrollBarVisibility"
                           RelativeSource="{RelativeSource TemplatedParent}"/>
                  <Binding Path="VerticalOffset" RelativeSource="{RelativeSource TemplatedParent}"/>
                  <Binding Path="ExtentHeight" RelativeSource="{RelativeSource TemplatedParent}"/>
                  <Binding Path="ViewportHeight" RelativeSource="{RelativeSource TemplatedParent}"/>
                </MultiBinding>
              </RepeatButton.Visibility>
              <Path Data="{StaticResource Menu.DownArrowGlyph}"
                    Fill="{aero10:SystemAliasResource Menu.PopupItem.Normal.Foreground}"/>
            </RepeatButton>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{x:Static MenuItem.SeparatorStyleKey}" TargetType="{x:Type Separator}">
    <Setter Property="Background" Value="{aero10:SystemAliasResource Menu.PopupSeparator}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Menu.PopupSeparator}"/>
    <Setter Property="MinHeight" Value="4"/>
    <Setter Property="SnapsToDevicePixels" Value="True"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Separator}">
          <Border Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Margin="28,1,0,2"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{x:Type Separator}" TargetType="{x:Type Separator}">
    <Setter Property="Background" Value="{aero10:SystemAliasResource Menu.PopupSeparator}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Menu.PopupSeparator}"/>
    <Setter Property="MinHeight" Value="3"/>
    <Setter Property="SnapsToDevicePixels" Value="True"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate>
          <Border Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Margin="28,1,0,1"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <ControlTemplate x:Key="{ComponentResourceKey {x:Type MenuItem}, TopLevelItemTemplateKey}"
                   TargetType="{x:Type MenuItem}">
    <Border x:Name="TemplateRoot"
            SnapsToDevicePixels="True"
            BorderThickness="{TemplateBinding BorderThickness}"
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}">
      <Grid VerticalAlignment="Center">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <ContentPresenter x:Name="Icon"
                          ContentSource="Icon"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Center"
                          Width="16"
                          Height="16"
                          Margin="2"/>
        <Path x:Name="GlyphBorder"
              Data="{StaticResource Menu.CheckmarkGlyph}"
              FlowDirection="LeftToRight"
              Margin="2,-2"
              Width="16"
              Height="16"
              Visibility="Collapsed"
              VerticalAlignment="Center"
              Fill="{aero10:SystemAliasResource Menu.PopupCheck.Normal.Foreground}"/>
        <ContentPresenter Grid.Column="1"
                          ContentSource="Header"
                          RecognizesAccessKey="True"
                          Margin="{TemplateBinding Padding}"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
      </Grid>
    </Border>
    <ControlTemplate.Triggers>
      <Trigger Property="Icon" Value="{x:Null}">
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="IsChecked" Value="True">
        <Setter TargetName="GlyphBorder" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <MultiDataTrigger>
        <MultiDataTrigger.Conditions>
          <Condition Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}"
                     Value="False"/>
          <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}"
                     Value="False"/>
        </MultiDataTrigger.Conditions>
        <MultiDataTrigger.Setters>
          <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                  Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
          <Setter TargetName="GlyphBorder" Property="Fill"
                  Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
        </MultiDataTrigger.Setters>
      </MultiDataTrigger>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.BarItem.Hot.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.BarItem.Hot.Border}"/>
      </Trigger>
      <Trigger Property="IsSubmenuOpen" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Border}"/>
      </Trigger>
      <Trigger Property="IsPressed" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Border}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
        <Setter TargetName="GlyphBorder" Property="Fill"
                Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="{ComponentResourceKey {x:Type MenuItem}, TopLevelHeaderTemplateKey}"
                   TargetType="{x:Type MenuItem}">
    <Border x:Name="TemplateRoot"
            SnapsToDevicePixels="True"
            BorderThickness="{TemplateBinding BorderThickness}"
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}">
      <Grid VerticalAlignment="Center">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <ContentPresenter x:Name="Icon"
                          ContentSource="Icon"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Center"
                          Width="16"
                          Height="16"
                          Margin="2"/>
        <Path x:Name="GlyphBorder"
              Data="{StaticResource Menu.CheckmarkGlyph}"
              FlowDirection="LeftToRight"
              Margin="2"
              Width="16"
              Height="16"
              Visibility="Collapsed"
              VerticalAlignment="Center"
              Fill="{TemplateBinding Menu.Foreground}"/>
        <ContentPresenter Grid.Column="1"
                          ContentSource="Header"
                          RecognizesAccessKey="True"
                          Margin="{TemplateBinding Padding}"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        <Popup x:Name="PART_Popup"
               AllowsTransparency="True"
               Focusable="False"
               IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
               PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
               Placement="Bottom"
               PlacementTarget="{Binding ElementName=TemplateRoot}">
          <aero10:SystemDropShadowChrome x:Name="Shdw" Color="Transparent">
            <Border x:Name="SubMenuBorder"
                    Background="{aero10:SystemAliasResource Menu.Popup.Background}"
                    BorderBrush="{aero10:SystemAliasResource Menu.Popup.Border}"
                    BorderThickness="1"
                    Padding="2">
              <ScrollViewer x:Name="SubMenuScrollViewer"
                            Style="{DynamicResource {ComponentResourceKey {x:Type FrameworkElement}, MenuScrollViewer}}">
                <Grid RenderOptions.ClearTypeHint="Enabled">
                  <Canvas Height="0" Width="0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Rectangle
                      x:Name="OpaqueRect"
                      Height="{Binding ActualHeight, ElementName=SubMenuBorder}"
                      Width="{Binding ActualWidth, ElementName=SubMenuBorder}"
                      Fill="{Binding Background, ElementName=SubMenuBorder}"/>
                  </Canvas>
                  <Border x:Name="PopupGutter"
                          HorizontalAlignment="Left"
                          Width="28"
                          Background="{aero10:SystemAliasResource Menu.PopupGutter.Background}"
                          BorderBrush="{aero10:SystemAliasResource Menu.PopupGutter.Border}"
                          BorderThickness="0,0,1,0"/>
                  <ItemsPresenter x:Name="ItemsPresenter"
                                  KeyboardNavigation.DirectionalNavigation="Cycle"
                                  KeyboardNavigation.TabNavigation="Cycle"
                                  Grid.IsSharedSizeScope="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                </Grid>
              </ScrollViewer>
            </Border>
          </aero10:SystemDropShadowChrome>
        </Popup>
      </Grid>
    </Border>
    <ControlTemplate.Triggers>
      <Trigger Property="IsSuspendingPopupAnimation" Value="True">
        <Setter TargetName="PART_Popup" Property="PopupAnimation" Value="None"/>
      </Trigger>
      <Trigger Property="Icon" Value="{x:Null}">
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="IsChecked" Value="True">
        <Setter TargetName="GlyphBorder" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <MultiDataTrigger>
        <MultiDataTrigger.Conditions>
          <Condition Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}"
                     Value="False"/>
          <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}"
                     Value="False"/>
        </MultiDataTrigger.Conditions>
        <MultiDataTrigger.Setters>
          <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                  Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
          <Setter TargetName="GlyphBorder" Property="Fill"
                  Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
        </MultiDataTrigger.Setters>
      </MultiDataTrigger>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.BarItem.Hot.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.BarItem.Hot.Border}"/>
      </Trigger>
      <Trigger Property="IsSubmenuOpen" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Border}"/>
      </Trigger>
      <Trigger Property="IsPressed" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.BarItem.Pressed.Border}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
        <Setter TargetName="GlyphBorder" Property="Fill"
                Value="{aero10:SystemAliasResource Menu.BarItem.Disabled.Foreground}"/>
      </Trigger>
      <Trigger SourceName="PART_Popup" Property="Popup.HasDropShadow" Value="True">
        <Setter TargetName="Shdw" Property="Margin" Value="0,0,5,5"/>
        <Setter TargetName="Shdw" Property="Color" Value="#71000000"/>
      </Trigger>
      <Trigger SourceName="SubMenuScrollViewer" Property="ScrollViewer.CanContentScroll" Value="False">
        <Setter TargetName="OpaqueRect" Property="Canvas.Top"
                Value="{Binding VerticalOffset, ElementName=SubMenuScrollViewer}"/>
        <Setter TargetName="OpaqueRect" Property="Canvas.Left"
                Value="{Binding HorizontalOffset, ElementName=SubMenuScrollViewer}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="{ComponentResourceKey {x:Type MenuItem}, SubmenuItemTemplateKey}"
                   TargetType="{x:Type MenuItem}">
    <Border x:Name="TemplateRoot"
            SnapsToDevicePixels="True"
            Height="22"
            BorderThickness="{TemplateBinding BorderThickness}"
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" MinWidth="20" SharedSizeGroup="MenuItemIconColumnGroup"/>
          <ColumnDefinition Width="11"/>
          <ColumnDefinition Width="*" MinWidth="11"/>
          <ColumnDefinition Width="34"/>
          <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup"/>
          <ColumnDefinition Width="17" SharedSizeGroup="MenuItemArrowColumnGroup"/>
        </Grid.ColumnDefinitions>
        <ContentPresenter x:Name="Icon"
                          ContentSource="Icon"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Left"
                          Width="16"
                          Height="16"
                          Margin="2"/>
        <Border x:Name="GlyphBorder"
                Visibility="Hidden"
                Height="22"
                Width="22"
                VerticalAlignment="Center"
                HorizontalAlignment="Center"
                Background="{aero10:SystemAliasResource Menu.PopupCheckBackground.Normal.Background}"
                BorderBrush="{aero10:SystemAliasResource Menu.PopupCheckBackground.Normal.Border}"
                BorderThickness="1"
                ClipToBounds="False"
                Margin="-1">
          <Path x:Name="Glyph"
                Data="{StaticResource Menu.CheckmarkGlyph}"
                FlowDirection="LeftToRight"
                Height="16"
                Width="16"
                Margin="2"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Fill="{aero10:SystemAliasResource Menu.PopupCheck.Normal.Foreground}"/>
        </Border>
        <Border x:Name="MenuHeaderContainer"
                Grid.Column="2"
                Margin="0"
                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
          <ContentPresenter HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            ContentSource="Header"
                            RecognizesAccessKey="True"
                            Margin="{TemplateBinding Padding}"
                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <Border x:Name="MenuGestureContainer" Grid.Column="4" Margin="0">
          <TextBlock Text="{TemplateBinding InputGestureText}"
                     Margin="{TemplateBinding Padding}"
                     VerticalAlignment="Center"/>
        </Border>
      </Grid>
    </Border>
    <ControlTemplate.Triggers>
      <DataTrigger Binding="{Binding Header, RelativeSource={RelativeSource Self}, Converter={StaticResource TypeOfConverter}}"
                   Value="{x:Type system:String}">
        <Setter TargetName="MenuHeaderContainer" Property="Margin" Value="0,-1,0,0"/>
        <Setter TargetName="MenuGestureContainer" Property="Margin" Value="0,-1,0,0"/>
      </DataTrigger>
      <Trigger Property="Icon" Value="{x:Null}">
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="IsChecked" Value="True">
        <Setter TargetName="GlyphBorder" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="IsHighlighted" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Hot.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Hot.Border}"/>
        <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Hot.Foreground}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsEnabled" Value="False"/>
          <Condition Property="IsHighlighted" Value="True"/>
        </MultiTrigger.Conditions>
        <MultiTrigger.Setters>
          <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.PopupItem.DisabledHot.Background}"/>
          <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.PopupItem.DisabledHot.Border}"/>
        </MultiTrigger.Setters>
      </MultiTrigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Disabled.Foreground}"/>
        <Setter TargetName="Glyph" Property="Fill"
                Value="{aero10:SystemAliasResource Menu.PopupCheck.Disabled.Foreground}"/>
        <Setter TargetName="GlyphBorder" Property="Background"
                Value="{aero10:SystemAliasResource Menu.PopupCheckBackground.Disabled.Background}"/>
        <Setter TargetName="GlyphBorder" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.PopupCheckBackground.Disabled.Border}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="{ComponentResourceKey {x:Type MenuItem}, SubmenuHeaderTemplateKey}"
                   TargetType="{x:Type MenuItem}">
    <Border x:Name="TemplateRoot"
            SnapsToDevicePixels="True"
            Height="22"
            BorderThickness="{TemplateBinding BorderThickness}"
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" MinWidth="20" SharedSizeGroup="MenuItemIconColumnGroup"/>
          <ColumnDefinition Width="11"/>
          <ColumnDefinition Width="*" MinWidth="11"/>
          <ColumnDefinition Width="34"/>
          <ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup"/>
          <ColumnDefinition Width="17" SharedSizeGroup="MenuItemArrowColumnGroup"/>
        </Grid.ColumnDefinitions>
        <ContentPresenter x:Name="Icon"
                          ContentSource="Icon"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                          VerticalAlignment="Center"
                          HorizontalAlignment="Center"
                          Width="16"
                          Height="16"
                          Margin="2"/>
        <Border x:Name="GlyphBorder"
                BorderThickness="1"
                Height="22"
                Width="22"
                Visibility="Hidden"
                VerticalAlignment="Center"
                Margin="-1,-1,-1,-1"
                BorderBrush="{aero10:SystemAliasResource Menu.PopupItem.Hot.Border}"
                Background="{aero10:SystemAliasResource Menu.PopupItem.Hot.Background}">
          <Path x:Name="Glyph"
                Data="{StaticResource Menu.CheckmarkGlyph}"
                FlowDirection="LeftToRight"
                Height="16"
                Width="16"
                Fill="{aero10:SystemAliasResource Menu.PopupCheck.Normal.Foreground}"/>
        </Border>
        <Border x:Name="MenuHeaderContainer"
                Grid.Column="2"
                Margin="0,-1,0,0"
                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
          <ContentPresenter HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            ContentSource="Header"
                            RecognizesAccessKey="True"
                            Margin="{TemplateBinding Padding}"
                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <Border x:Name="MenuGestureContainer" Grid.Column="4" Margin="0,-1,0,0">
          <TextBlock Text="{TemplateBinding InputGestureText}"
                     Margin="{TemplateBinding Padding}"
                     VerticalAlignment="Center"/>
        </Border>
        <Path x:Name="RightArrow"
              Grid.Column="5"
              Data="{StaticResource Menu.PopupSubmenu.Glyph}"
              Margin="5,0,0,1"
              VerticalAlignment="Center"
              HorizontalAlignment="Left"
              Fill="{aero10:SystemAliasResource Menu.PopupSubmenu.Normal.Foreground}"
              UseLayoutRounding="False"/>
        <Popup x:Name="PART_Popup"
               AllowsTransparency="True"
               Focusable="False"
               IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}"
               PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
               Placement="Right"
               HorizontalOffset="-2"
               VerticalOffset="-4">
          <aero10:SystemDropShadowChrome x:Name="Shdw" Color="Transparent">
            <Border x:Name="SubMenuBorder"
                    Background="{aero10:SystemAliasResource Menu.Popup.Background}"
                    BorderBrush="{aero10:SystemAliasResource Menu.Popup.Border}"
                    BorderThickness="1"
                    Padding="2">
              <ScrollViewer x:Name="SubMenuScrollViewer"
                          Style="{DynamicResource {ComponentResourceKey {x:Type FrameworkElement}, MenuScrollViewer}}">
                <Grid RenderOptions.ClearTypeHint="Enabled">
                  <Canvas Height="0" Width="0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Rectangle
                      x:Name="OpaqueRect"
                      Height="{Binding ActualHeight, ElementName=SubMenuBorder}"
                      Width="{Binding ActualWidth, ElementName=SubMenuBorder}"
                      Fill="{Binding Background, ElementName=SubMenuBorder}"/>
                  </Canvas>
                  <Border x:Name="PopupGutter"
                          HorizontalAlignment="Left"
                          Width="28"
                          Background="{aero10:SystemAliasResource Menu.PopupGutter.Background}"
                          BorderBrush="{aero10:SystemAliasResource Menu.PopupGutter.Border}"
                          BorderThickness="0,0,1,0"/>
                  <ItemsPresenter x:Name="ItemsPresenter"
                                  KeyboardNavigation.DirectionalNavigation="Cycle"
                                  KeyboardNavigation.TabNavigation="Cycle"
                                  Grid.IsSharedSizeScope="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                </Grid>
              </ScrollViewer>
            </Border>
          </aero10:SystemDropShadowChrome>
        </Popup>
      </Grid>
    </Border>
    <ControlTemplate.Triggers>
      <DataTrigger Binding="{Binding Header, RelativeSource={RelativeSource Self}, Converter={StaticResource TypeOfConverter}}"
                   Value="{x:Type system:String}">
        <Setter TargetName="MenuHeaderContainer" Property="Margin" Value="0,-1,0,0"/>
        <Setter TargetName="MenuGestureContainer" Property="Margin" Value="0,-1,0,0"/>
      </DataTrigger>
      <Trigger Property="IsSuspendingPopupAnimation" Value="True">
        <Setter TargetName="PART_Popup" Property="PopupAnimation" Value="None"/>
      </Trigger>
      <Trigger Property="Icon" Value="{x:Null}">
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="IsChecked" Value="True">
        <Setter TargetName="GlyphBorder" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Icon" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="IsHighlighted" Value="True">
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Hot.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Hot.Border}"/>
        <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Hot.Foreground}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                Value="{aero10:SystemAliasResource Menu.PopupItem.Disabled.Foreground}"/>
        <Setter TargetName="Glyph" Property="Fill"
                Value="{aero10:SystemAliasResource Menu.PopupCheck.Disabled.Foreground}"/>
        <Setter TargetName="RightArrow" Property="Fill"
                Value="{aero10:SystemAliasResource Menu.PopupSubmenu.Disabled.Foreground}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsHighlighted" Value="True"/>
          <Condition Property="IsEnabled" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="TemplateRoot" Property="Background"
                Value="{aero10:SystemAliasResource Menu.PopupItem.DisabledHot.Background}"/>
        <Setter TargetName="TemplateRoot" Property="BorderBrush"
                Value="{aero10:SystemAliasResource Menu.PopupItem.DisabledHot.Border}"/>
        <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                Value="{aero10:SystemAliasResource Menu.PopupItem.DisabledHot.Foreground}"/>
      </MultiTrigger>
      <Trigger SourceName="PART_Popup" Property="Popup.HasDropShadow" Value="True">
        <Setter TargetName="Shdw" Property="Margin" Value="0,0,5,5"/>
        <Setter TargetName="Shdw" Property="Color" Value="#71000000"/>
      </Trigger>
      <Trigger SourceName="SubMenuScrollViewer" Property="ScrollViewer.CanContentScroll" Value="False">
        <Setter TargetName="OpaqueRect" Property="Canvas.Top"
                Value="{Binding VerticalOffset, ElementName=SubMenuScrollViewer}"/>
        <Setter TargetName="OpaqueRect" Property="Canvas.Left"
                Value="{Binding HorizontalOffset, ElementName=SubMenuScrollViewer}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <Style TargetType="{x:Type MenuItem}">
    <Setter Property="HorizontalContentAlignment"
            Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="VerticalContentAlignment"
            Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="Template"
            Value="{DynamicResource {ComponentResourceKey {x:Type MenuItem}, SubmenuItemTemplateKey}}"/>
    <Style.Triggers>
      <Trigger Property="Role" Value="TopLevelHeader">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Menu.BarItem.Normal.Foreground}"/>
        <Setter Property="Template"
                Value="{DynamicResource {ComponentResourceKey {x:Type MenuItem}, TopLevelHeaderTemplateKey}}"/>
        <Setter Property="Padding" Value="6,1"/>
      </Trigger>
      <Trigger Property="Role" Value="TopLevelItem">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Menu.BarItem.Normal.Foreground}"/>
        <Setter Property="Template"
                Value="{DynamicResource {ComponentResourceKey {x:Type MenuItem}, TopLevelItemTemplateKey}}"/>
        <Setter Property="Padding" Value="6,1"/>
      </Trigger>
      <Trigger Property="Role" Value="SubmenuHeader">
        <Setter Property="Template"
                Value="{DynamicResource {ComponentResourceKey {x:Type MenuItem}, SubmenuHeaderTemplateKey}}"/>
      </Trigger>
    </Style.Triggers>
  </Style>

  <Style TargetType="{x:Type Menu}">
    <Setter Property="Background" Value="{aero10:SystemAliasResource Menu.BarBackground.Background}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Menu.BarBackground.Border}"/>
    <Setter Property="BorderThickness" Value="0,0,0,1"/>
    <Setter Property="FontFamily" Value="{DynamicResource {x:Static SystemFonts.MenuFontFamilyKey}}"/>
    <Setter Property="FontSize" Value="{DynamicResource {x:Static SystemFonts.MenuFontSizeKey}}"/>
    <Setter Property="FontStyle" Value="{DynamicResource {x:Static SystemFonts.MenuFontStyleKey}}"/>
    <Setter Property="FontWeight" Value="{DynamicResource {x:Static SystemFonts.MenuFontWeightKey}}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Menu}">
          <Border
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            Padding="{TemplateBinding Padding}"
            SnapsToDevicePixels="True">
            <ItemsPresenter
              Margin="0,0,0,-1"
              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{x:Type ContextMenu}" TargetType="{x:Type ContextMenu}">
    <Setter Property="FontFamily" Value="{DynamicResource {x:Static SystemFonts.MenuFontFamilyKey}}"/>
    <Setter Property="FontSize" Value="{DynamicResource {x:Static SystemFonts.MenuFontSizeKey}}"/>
    <Setter Property="FontStyle" Value="{DynamicResource {x:Static SystemFonts.MenuFontStyleKey}}"/>
    <Setter Property="FontWeight" Value="{DynamicResource {x:Static SystemFonts.MenuFontWeightKey}}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource Menu.Popup.Background}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource Menu.Popup.Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Padding" Value="2"/>
    <Setter Property="Grid.IsSharedSizeScope" Value="True"/>
    <Setter Property="HasDropShadow" Value="{DynamicResource {x:Static SystemParameters.DropShadowKey}}"/>
    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ContextMenu}">
          <aero10:SystemDropShadowChrome x:Name="Shdw"
                                        Color="Transparent"
                                        SnapsToDevicePixels="True">
            <Border x:Name="ContextMenuBorder"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}">
              <ScrollViewer x:Name="ContextMenuScrollViewer"
                            Margin="0"
                            Style="{DynamicResource {ComponentResourceKey {x:Type FrameworkElement}, MenuScrollViewer}}">
                <Grid RenderOptions.ClearTypeHint="Enabled">
                  <Canvas Height="0" Width="0" HorizontalAlignment="Left" VerticalAlignment="Top">
                    <Rectangle
                      x:Name="OpaqueRect"
                      Height="{Binding ActualHeight, ElementName=ContextMenuBorder}"
                      Width="{Binding ActualWidth, ElementName=ContextMenuBorder}"
                      Fill="{Binding Background, ElementName=ContextMenuBorder}"/>
                  </Canvas>
                  <Border x:Name="PopupGutter"
                          HorizontalAlignment="Left"
                          Width="28"
                          Margin="2,2,0,2"
                          Background="{aero10:SystemAliasResource Menu.PopupGutter.Background}"
                          BorderBrush="{aero10:SystemAliasResource Menu.PopupGutter.Border}"
                          BorderThickness="0,0,1,0"/>
                  <ItemsPresenter x:Name="ItemsPresenter"
                                  Margin="{TemplateBinding Padding}"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                  KeyboardNavigation.DirectionalNavigation="Cycle"/>
                </Grid>
              </ScrollViewer>
            </Border>
          </aero10:SystemDropShadowChrome>
          <ControlTemplate.Triggers>
            <Trigger Property="HasDropShadow" Value="True">
              <Setter TargetName="Shdw" Property="Margin" Value="0,0,5,5"/>
              <Setter TargetName="Shdw" Property="Color" Value="#71000000"/>
            </Trigger>
            <Trigger SourceName="ContextMenuScrollViewer"
                     Property="ScrollViewer.CanContentScroll"
                     Value="False">
              <Setter TargetName="OpaqueRect"
                      Property="Canvas.Top"
                      Value="{Binding VerticalOffset, ElementName=ContextMenuScrollViewer}"/>
              <Setter TargetName="OpaqueRect"
                      Property="Canvas.Left"
                      Value="{Binding HorizontalOffset, ElementName=ContextMenuScrollViewer}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>


  <!-- ScrollBar =========================================================== -->

  <Style x:Key="RepeatButtonTransparent" TargetType="{x:Type RepeatButton}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RepeatButton}">
          <Rectangle Fill="{TemplateBinding Background}"
                     Width="{TemplateBinding Width}"
                     Height="{TemplateBinding Height}"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ScrollBarButtonUp" TargetType="{x:Type RepeatButton}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RepeatButton}">
          <Border x:Name="Border"
                  SnapsToDevicePixels="True"
                  Background="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Normal}"
                  BorderBrush="{aero10:SystemAliasResource ScrollBar.Border}"
                  BorderThickness="1">
            <!-- Up glyph is moved 1px down. -->
            <Path x:Name="Glyph"
                  Data="M0,4.5 0,6.5 3.5,3 7,6.5 7,4.5 3.5,1z"
                  Stretch="Uniform"
                  Margin="3,4,3,2"
                  Fill="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Normal}"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                  SnapsToDevicePixels="True"
                  RenderOptions.EdgeMode="Aliased"
                  UseLayoutRounding="False"
                  Width="7"
                  Height="7"
                  Focusable="False"/>
          </Border>
          <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollBar}}}" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hover}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hover}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hover}"/>
            </DataTrigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hot}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hot}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Pressed}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Pressed}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Disabled}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Disabled}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Disabled}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ScrollBarButtonDown" TargetType="{x:Type RepeatButton}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RepeatButton}">
          <Border x:Name="Border"
                  SnapsToDevicePixels="True"
                  Background="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Normal}"
                  BorderBrush="{aero10:SystemAliasResource ScrollBar.Border}"
                  BorderThickness="1">
            <Path x:Name="Glyph"
                  Data="M0,2 0,0 3.5,3.5 7,0 7,2 3.5,5.5 z"
                  Stretch="Uniform"
                  Margin="3,3,3,4"
                  Fill="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Normal}"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                  SnapsToDevicePixels="True"
                  RenderOptions.EdgeMode="Aliased"
                  UseLayoutRounding="False"
                  Width="7"
                  Height="7"
                  Focusable="False"/>
          </Border>
          <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollBar}}}" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hover}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hover}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hover}"/>
            </DataTrigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hot}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hot}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Pressed}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Pressed}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Disabled}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Disabled}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Disabled}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ScrollBarButtonLeft" TargetType="{x:Type RepeatButton}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RepeatButton}">
          <Border x:Name="Border"
                  SnapsToDevicePixels="True"
                  Background="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Normal}"
                  BorderBrush="{aero10:SystemAliasResource ScrollBar.Border}"
                  BorderThickness="1">
            <Path x:Name="Glyph"
                  Data="M1,3.5 4.5,0 6.5,0 3,3.5 6.5,7 4.5,7 z"
                  Stretch="Uniform"
                  Margin="4,3,3,3"
                  Fill="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Normal}"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                  SnapsToDevicePixels="True"
                  RenderOptions.EdgeMode="Aliased"
                  UseLayoutRounding="False"
                  Width="7"
                  Height="7"/>
          </Border>
          <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollBar}}}" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hover}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hover}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hover}"/>
            </DataTrigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hot}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hot}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Pressed}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Pressed}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Disabled}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Disabled}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Disabled}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ScrollBarButtonRight" TargetType="{x:Type RepeatButton}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type RepeatButton}">
          <Border x:Name="Border"
                  SnapsToDevicePixels="True"
                  Background="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Normal}"
                  BorderBrush="{aero10:SystemAliasResource ScrollBar.Border}"
                  BorderThickness="1">
            <Path x:Name="Glyph"
                  Data="M2,7 0,7 3.5,3.5 0,0 2,0 5.5,3.5 z"
                  Stretch="Uniform"
                  Margin="3,3,4,3"
                  Fill="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Normal}"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                  SnapsToDevicePixels="True"
                  RenderOptions.EdgeMode="Aliased"
                  UseLayoutRounding="False"
                  Width="7"
                  Height="7"/>
          </Border>
          <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollBar}}}" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hover}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hover}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hover}"/>
            </DataTrigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Hot}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Hot}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Pressed}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Pressed}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Background.Disabled}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Border.Disabled}"/>
              <Setter TargetName="Glyph" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.ArrowButton.Glyph.Disabled}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ScrollBarThumbVertical" TargetType="{x:Type Thumb}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Thumb}">
          <Border x:Name="Border"
                  Background="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Normal}"
                  BorderBrush="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Normal}"
                  BorderThickness="1"
                  SnapsToDevicePixels="True"
                  Width="{TemplateBinding Width}"
                  Height="{TemplateBinding Height}">
            <Grid>
              <Path x:Name="Gripper"
                  Data="M1,1 1,3 8,3 8,1z M1,4 1,6 8,6 8,4z M1,7 1,9 8,9 8,7 z"
                  Fill="{aero10:SystemAliasResource ScrollBar.Gripper.Normal}"
                  Width="9"
                  Height="10"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"/>
            </Grid>
          </Border>
          <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollBar}}}" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Hover}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Hover}"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Hover}"/>
            </DataTrigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Hot}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Hot}"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Hot}"/>
            </Trigger>
            <Trigger Property="IsDragging" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Pressed}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Pressed}"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Disabled}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Disabled}"/>
              <Setter TargetName="Border" Property="BorderThickness" Value="1,0,1,0"/>
              <Setter TargetName="Border" Property="Visibility" Value="Collapsed"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Disabled}"/>
            </Trigger>
            <DataTrigger Binding="{aero10:LessThanOrEqualBinding ActualHeight, Threshold=18, ElementName=Border}" Value="True">
              <Setter TargetName="Gripper" Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ScrollBarThumbHorizontal" TargetType="{x:Type Thumb}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Thumb}">
          <Border x:Name="Border"
                  Background="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Normal}"
                  BorderBrush="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Normal}"
                  BorderThickness="1"
                  SnapsToDevicePixels="True"
                  Width="{TemplateBinding Width}"
                  Height="{TemplateBinding Height}">
            <Path x:Name="Gripper"
                  Data="M1,1 3,1 3,8 1,8z M4,1 6,1 6,8 4,8z M7,1 9,1 9,8 7,8 z"
                  Fill="{aero10:SystemAliasResource ScrollBar.Gripper.Normal}"
                  Width="10"
                  Height="9"/>
          </Border>
          <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollBar}}}" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Hover}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Hover}"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Hover}"/>
            </DataTrigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Hot}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Hot}"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Hot}"/>
            </Trigger>
            <Trigger Property="IsDragging" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Pressed}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Pressed}"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Background.Disabled}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Thumb.Border.Disabled}"/>
              <Setter TargetName="Border" Property="BorderThickness" Value="0,1,0,1"/>
              <Setter TargetName="Border" Property="Visibility" Value="Collapsed"/>
              <Setter TargetName="Gripper" Property="Fill" Value="{aero10:SystemAliasResource ScrollBar.Gripper.Disabled}"/>
            </Trigger>
            <DataTrigger Binding="{aero10:LessThanOrEqualBinding ActualWidth, Threshold=18, ElementName=Border}" Value="True">
              <Setter TargetName="Gripper" Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}">
    <Setter Property="Stylus.IsPressAndHoldEnabled" Value="False"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource ScrollBar.Background}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ScrollBar.Border}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="BorderThickness" Value="1,0"/>
    <Setter Property="Width" Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
    <Setter Property="MinWidth"
            Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ScrollBar}">
          <Grid SnapsToDevicePixels="True">
            <Grid.RowDefinitions>
              <RowDefinition
                MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
              <RowDefinition Height="0.00001*"/>
              <RowDefinition
                MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
            </Grid.RowDefinitions>
            <Border Grid.Row="1"
                    Background="{aero10:SystemAliasResource ScrollBar.Background}"
                    BorderBrush="{aero10:SystemAliasResource ScrollBar.Border}"
                    SnapsToDevicePixels="True"
                    BorderThickness="1,0,1,0"/>
            <RepeatButton x:Name="PART_LineUpButton"
                          Command="{x:Static ScrollBar.LineUpCommand}"
                          Style="{StaticResource ScrollBarButtonUp}"/>
            <Track x:Name="PART_Track"
                   Grid.Row="1"
                   IsDirectionReversed="True">
              <Track.DecreaseRepeatButton>
                <RepeatButton Command="{x:Static ScrollBar.PageUpCommand}"
                              Style="{StaticResource RepeatButtonTransparent}"/>
              </Track.DecreaseRepeatButton>
              <Track.IncreaseRepeatButton>
                <RepeatButton Command="{x:Static ScrollBar.PageDownCommand}"
                              Style="{StaticResource RepeatButtonTransparent}"/>
              </Track.IncreaseRepeatButton>
              <Track.Thumb>
                <Thumb Style="{StaticResource ScrollBarThumbVertical}"/>
              </Track.Thumb>
            </Track>
            <RepeatButton x:Name="PART_LineDownButton"
                          Grid.Row="2"
                          Command="{x:Static ScrollBar.LineDownCommand}"
                          Style="{StaticResource ScrollBarButtonDown}"/>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="Orientation" Value="Horizontal">
        <Setter Property="Width" Value="Auto"/>
        <Setter Property="MinWidth" Value="0"/>
        <Setter Property="Height"
                Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"/>
        <Setter Property="MinHeight"
                Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"/>
        <Setter Property="BorderThickness" Value="0,1"/>
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type ScrollBar}">
              <Grid SnapsToDevicePixels="True">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition
                    MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
                  <ColumnDefinition Width="0.00001*"/>
                  <ColumnDefinition
                    MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
                </Grid.ColumnDefinitions>
                <Border Grid.Column="1"
                        Background="{aero10:SystemAliasResource ScrollBar.Background}"
                        BorderBrush="{aero10:SystemAliasResource ScrollBar.Border}"
                        SnapsToDevicePixels="True"
                        BorderThickness="0,1,0,1"/>
                <RepeatButton x:Name="PART_LineLeftButton"
                              Command="{x:Static ScrollBar.LineLeftCommand}"
                              Style="{StaticResource ScrollBarButtonLeft}"/>
                <Track x:Name="PART_Track" Grid.Column="1">
                  <Track.DecreaseRepeatButton>
                    <RepeatButton Command="{x:Static ScrollBar.PageLeftCommand}"
                                  Style="{StaticResource RepeatButtonTransparent}"/>
                  </Track.DecreaseRepeatButton>
                  <Track.IncreaseRepeatButton>
                    <RepeatButton Command="{x:Static ScrollBar.PageRightCommand}"
                                  Style="{StaticResource RepeatButtonTransparent}"/>
                  </Track.IncreaseRepeatButton>
                  <Track.Thumb>
                    <Thumb Style="{StaticResource ScrollBarThumbHorizontal}"/>
                  </Track.Thumb>
                </Track>
                <RepeatButton x:Name="PART_LineRightButton"
                              Grid.Column="2"
                              Command="{x:Static ScrollBar.LineRightCommand}"
                              Style="{StaticResource ScrollBarButtonRight}"/>
              </Grid>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Trigger>
    </Style.Triggers>
  </Style>

  <!-- TreeView ============================================================ -->

  <PathGeometry x:Key="TreeArrow">
    <PathGeometry.Figures>
      <PathFigureCollection>
        <PathFigure IsFilled="True" StartPoint="0 0" IsClosed="True">
          <PathFigure.Segments>
            <PathSegmentCollection>
              <LineSegment Point="0 6"/>
              <LineSegment Point="6 0"/>
            </PathSegmentCollection>
          </PathFigure.Segments>
        </PathFigure>
      </PathFigureCollection>
    </PathGeometry.Figures>
  </PathGeometry>

  <DrawingImage x:Key="TreeViewGlyphMinus">
    <DrawingImage.Drawing>
      <DrawingGroup>
        <GeometryDrawing Brush="#FFA3A3A3" Geometry="M0,0 9,0 9,9 0,9 z"/>
        <GeometryDrawing Brush="#FFE2E2E2" Geometry="M1,1 8,1 8,8 1,8 z"/>
        <GeometryDrawing Brush="#FF333333" Geometry="M2,4 7,4 7,5 2,5 z"/>
      </DrawingGroup>
    </DrawingImage.Drawing>
  </DrawingImage>

  <DrawingImage x:Key="TreeViewGlyphPlus">
    <DrawingImage.Drawing>
      <DrawingGroup>
        <GeometryDrawing Brush="#FFA3A3A3" Geometry="M0,0 9,0 9,9 0,9 z"/>
        <GeometryDrawing Brush="#FFE2E2E2" Geometry="M1,1 8,1 8,8 1,8 z"/>
        <GeometryDrawing Brush="#FF333333" Geometry="M2,4 4,4 4,2 5,2 5,4 7,4 7,5 5,5 5,7 4,7 4,5 2,5 z"/>
      </DrawingGroup>
    </DrawingImage.Drawing>
  </DrawingImage>

  <Style x:Key="TreeViewItem.ExpanderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="Width" Value="19"/>
    <Setter Property="VerticalAlignment" Value="Stretch"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border Background="Transparent">
            <Image x:Name="Glyph" Source="{StaticResource TreeViewGlyphPlus}"
                   Width="9" Height="9" Margin="0,3,0,0"/>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="Glyph" Property="Source" Value="{StaticResource TreeViewGlyphMinus}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <ControlTemplate x:Key="TreeViewItem.Template.Default" TargetType="{x:Type TreeViewItem}">
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" MinWidth="19"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
      </Grid.RowDefinitions>
      <ToggleButton x:Name="Expander"
                    Style="{StaticResource TreeViewItem.ExpanderStyle}"
                    Margin="3,0,0,0"
                    IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                    ClickMode="Press"/>
      <Border x:Name="Bd"
              Grid.Column="1"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              Padding="{TemplateBinding Padding}"
              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
              SnapsToDevicePixels="True">
        <ContentPresenter x:Name="PART_Header"
                          ContentSource="Header"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
      </Border>
      <ItemsPresenter x:Name="ItemsHost"
                      Margin="19,0,0,0"
                      Grid.Row="1"
                      Grid.ColumnSpan="2"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsExpanded" Value="False">
        <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="HasItems" Value="False">
        <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
      </Trigger>
      <Trigger Property="IsSelected" Value="True">
        <Setter TargetName="Bd" Property="Background"
                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelected" Value="True"/>
          <Condition Property="IsSelectionActive" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background"
                Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}}"/>
      </MultiTrigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="TreeViewItem.Template.FullRowSelect" TargetType="{x:Type TreeViewItem}">
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
      </Grid.RowDefinitions>
      <Border x:Name="Bd"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              SnapsToDevicePixels="True">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1e300">
              <ColumnDefinition.MaxWidth>
                <Binding RelativeSource="{RelativeSource TemplatedParent}"
                         Converter="{x:Static aero:TreeViewItemLevelConverter.Instance}">
                  <Binding.ConverterParameter>
                    <system:Int32>19</system:Int32>
                  </Binding.ConverterParameter>
                </Binding>
              </ColumnDefinition.MaxWidth>
            </ColumnDefinition>
            <ColumnDefinition Width="Auto" MinWidth="19"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          <ToggleButton x:Name="Expander" Grid.Column="1"
                        Style="{StaticResource TreeViewItem.ExpanderStyle}"
                        Margin="3,0,0,0"
                        IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                        ClickMode="Press"/>
          <ContentPresenter x:Name="PART_Header" Grid.Column="2"
                            ContentSource="Header"
                            Margin="{TemplateBinding Padding}"
                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Grid>
      </Border>
      <ItemsPresenter x:Name="ItemsHost" Grid.Row="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsExpanded" Value="False">
        <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="HasItems" Value="False">
        <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
      </Trigger>
      <Trigger Property="IsSelected" Value="True">
        <Setter TargetName="Bd" Property="Background"
                Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelected" Value="True"/>
          <Condition Property="IsSelectionActive" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background"
                Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}}"/>
      </MultiTrigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <Geometry x:Key="ExplorerTreeViewGlyphPlus">
    F1 M4.88,5.12 6.119,3.881 10.119,7.881 10.737,8.5 6.119,13.119 4.881,11.881 8.881,7.881 9.5,8.5 8.881,9.119 4.881,5.119 z
  </Geometry>

  <Geometry x:Key="ExplorerTreeViewGlyphMinus">
    F1 M2.88,6.12 4.119,4.881 8.119,8.881 7.5,9.5 6.881,8.881 10.881,4.881 12.119,6.119 7.5,10.737 6.881,10.119 2.881,6.119 z
  </Geometry>

  <Style x:Key="Explorer.TreeViewItem.ExpanderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="VerticalAlignment" Value="Stretch"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border x:Name="Bd" Background="Transparent">
            <Path x:Name="Glyph" Data="{StaticResource ExplorerTreeViewGlyphPlus}"
                  Width="16" Height="16" Stretch="None" Margin="1,0,0,0">
              <Path.Fill>
                <SolidColorBrush Color="{DynamicResource {x:Static SystemColors.ControlTextColorKey}}"
                                 Opacity="0.35"/>
              </Path.Fill>
            </Path>
          </Border>
          <ControlTemplate.Triggers>
            <!-- Account for the weird rounding behavior of SysTreeView, at
                 least for the default height. -->
            <DataTrigger Value="True">
              <DataTrigger.Binding>
                <MultiBinding Converter="{StaticResource EqualsConverter}">
                  <Binding Path="ActualHeight" RelativeSource="{RelativeSource Self}"/>
                  <Binding>
                    <Binding.Source>
                      <system:Double>18</system:Double>
                    </Binding.Source>
                  </Binding>
                </MultiBinding>
              </DataTrigger.Binding>
              <Setter TargetName="Glyph" Property="Margin" Value="1,2,0,0"/>
            </DataTrigger>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="Glyph" Property="Data" Value="{StaticResource ExplorerTreeViewGlyphMinus}"/>
              <Setter TargetName="Glyph" Property="Fill">
                <Setter.Value>
                  <SolidColorBrush Color="{DynamicResource {x:Static SystemColors.ControlTextColorKey}}"
                                   Opacity="0.5"/>
                </Setter.Value>
              </Setter>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Glyph" Property="Fill">
                <Setter.Value>
                  <SolidColorBrush Color="{DynamicResource {x:Static SystemColors.ControlTextColorKey}}"
                                   Opacity="0.75"/>
                </Setter.Value>
              </Setter>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <ControlTemplate x:Key="Explorer.TreeViewItem.Template.Default" TargetType="{x:Type TreeViewItem}">
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" MinWidth="19"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
      </Grid.RowDefinitions>
      <ToggleButton x:Name="Expander"
                    Style="{StaticResource Explorer.TreeViewItem.ExpanderStyle}"
                    Margin="3,0,0,0"
                    IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                    ClickMode="Press"/>
      <Border x:Name="Bd"
              Grid.Column="1"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
              SnapsToDevicePixels="True">
        <Border x:Name="InnerBd"
                Padding="{TemplateBinding Padding}">
        <ContentPresenter x:Name="PART_Header"
                          ContentSource="Header"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
      </Border>
      <ItemsPresenter x:Name="ItemsHost"
                      Margin="19,0,0,0"
                      Grid.Row="1"
                      Grid.ColumnSpan="2"/>
    </Grid>
    <ControlTemplate.Triggers>
      <DataTrigger Value="True">
        <DataTrigger.Binding>
          <MultiBinding Converter="{StaticResource EqualsConverter}">
            <Binding Path="ActualHeight" ElementName="InnerBd"/>
            <Binding>
              <Binding.Source>
                <system:Double>17</system:Double>
              </Binding.Source>
            </Binding>
          </MultiBinding>
        </DataTrigger.Binding>
        <Setter TargetName="InnerBd" Property="Margin" Value="0,-1,0,0"/>
      </DataTrigger>
      <Trigger Property="IsExpanded" Value="False">
        <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="HasItems" Value="False">
        <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition SourceName="Bd" Property="IsMouseOver" Value="True"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Background.HotSelected}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Border.HotSelected}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.HotSelected}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition SourceName="Bd" Property="IsMouseOver" Value="True"/>
          <Condition Property="IsSelected" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Background.Hot}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Border.Hot}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.Hot}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition SourceName="Bd" Property="IsMouseOver" Value="False"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Background.Selected}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Border.Selected}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.Selected}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelected" Value="True"/>
          <Condition Property="IsSelectionActive" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Background.SelectedNotFocus}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.ListView.Item.Border.SelectedNotFocus}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.SelectedNotFocus}"/>
      </MultiTrigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="Explorer.TreeViewItem.Template.FullRowSelect" TargetType="{x:Type TreeViewItem}">
    <Grid>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition/>
      </Grid.RowDefinitions>
      <Border x:Name="Bd"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              SnapsToDevicePixels="True">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1e300">
              <ColumnDefinition.MaxWidth>
                <Binding RelativeSource="{RelativeSource TemplatedParent}"
                         Converter="{x:Static aero:TreeViewItemLevelConverter.Instance}">
                  <Binding.ConverterParameter>
                    <system:Int32>19</system:Int32>
                  </Binding.ConverterParameter>
                </Binding>
              </ColumnDefinition.MaxWidth>
            </ColumnDefinition>
            <ColumnDefinition Width="Auto" MinWidth="19"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          <ToggleButton x:Name="Expander" Grid.Column="1"
                        Style="{StaticResource Explorer.TreeViewItem.ExpanderStyle}"
                        Margin="2,-1,1,-1"
                        IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                        ClickMode="Press"/>
          <Border x:Name="InnerBd" Grid.Column="2"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}">
            <ContentPresenter x:Name="PART_Header"
                              ContentSource="Header"
                              Margin="{TemplateBinding Padding}"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
          </Border>
        </Grid>
      </Border>
      <ItemsPresenter x:Name="ItemsHost" Grid.Row="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <DataTrigger Value="True">
        <DataTrigger.Binding>
          <MultiBinding Converter="{StaticResource EqualsConverter}">
            <Binding Path="ActualHeight" ElementName="InnerBd"/>
            <Binding>
              <Binding.Source>
                <system:Double>17</system:Double>
              </Binding.Source>
            </Binding>
          </MultiBinding>
        </DataTrigger.Binding>
        <Setter TargetName="InnerBd" Property="Margin" Value="0,-1,0,0"/>
      </DataTrigger>
      <Trigger Property="IsExpanded" Value="False">
        <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed"/>
      </Trigger>
      <Trigger Property="HasItems" Value="False">
        <Setter TargetName="Expander" Property="Visibility" Value="Hidden"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition SourceName="Bd" Property="IsMouseOver" Value="True"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Background.HotSelected}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Border.HotSelected}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.HotSelected}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition SourceName="Bd" Property="IsMouseOver" Value="True"/>
          <Condition Property="IsSelected" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Background.Hot}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Border.Hot}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.Hot}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition SourceName="Bd" Property="IsMouseOver" Value="False"/>
          <Condition Property="IsSelected" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Background.Selected}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Border.Selected}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.Selected}"/>
      </MultiTrigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelected" Value="True"/>
          <Condition Property="IsSelectionActive" Value="False"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Bd" Property="Background" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Background.SelectedNotFocus}"/>
        <Setter TargetName="Bd" Property="BorderBrush" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Border.SelectedNotFocus}"/>
        <Setter Property="Foreground" Value="{aero10:SystemAliasResource Explorer.TreeViewItem.Foreground.SelectedNotFocus}"/>
      </MultiTrigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="Explorer.TreeView.Template" TargetType="{x:Type TreeView}">
    <Border x:Name="Border"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            Padding="{TemplateBinding Padding}"
            SnapsToDevicePixels="True">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition/>
        </Grid.RowDefinitions>
        <ScrollViewer x:Name="ScrollViewer"
                      Grid.Row="1"
                      Background="{TemplateBinding Background}"
                      Focusable="False"
                      CanContentScroll="False"
                      HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                      VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
          <ItemsPresenter/>
        </ScrollViewer>
      </Grid>
    </Border>
    <ControlTemplate.Triggers>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="Border" Property="Background"
                Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
      </Trigger>
      <Trigger Property="VirtualizingPanel.IsVirtualizing" Value="True">
        <Setter TargetName="ScrollViewer" Property="CanContentScroll"
                Value="True"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <Style TargetType="{x:Type TreeView}">
    <Setter Property="Background" Value="{aero10:SystemAliasResource TreeView.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource TreeView.Border.Normal}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="Padding" Value="1"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.PanningMode" Value="Both"/>
    <Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
    <Setter Property="KeyboardNavigation.TabNavigation" Value="Once"/>
    <Setter Property="HorizontalContentAlignment" Value="Left"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type TreeView}">
          <Border x:Name="Border"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Padding="{TemplateBinding Padding}"
                  SnapsToDevicePixels="True">
            <ScrollViewer x:Name="ScrollViewer"
                          Background="{TemplateBinding Background}"
                          CanContentScroll="False"
                          HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                          VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
              <ItemsPresenter/>
            </ScrollViewer>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Border" Property="Background"
                      Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
            </Trigger>
            <Trigger Property="VirtualizingPanel.IsVirtualizing" Value="True">
              <Setter TargetName="ScrollViewer" Property="CanContentScroll"
                      Value="True"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="VirtualizingPanel.IsVirtualizing" Value="True">
        <Setter Property="ItemsPanel">
          <Setter.Value>
            <ItemsPanelTemplate>
              <VirtualizingStackPanel/>
            </ItemsPanelTemplate>
          </Setter.Value>
        </Setter>
      </Trigger>
      <Trigger Property="aero:ThemeOptions.UseExplorerStyle" Value="True">
        <Setter Property="Template" Value="{StaticResource Explorer.TreeView.Template}"/>
      </Trigger>
    </Style.Triggers>
  </Style>

  <Style TargetType="{x:Type TreeViewItem}">
    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="HorizontalContentAlignment"
            Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="VerticalContentAlignment"
            Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
    <Setter Property="Padding" Value="2,1,2,2"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
    <Setter Property="Template" Value="{StaticResource TreeViewItem.Template.Default}"/>
    <Style.Triggers>
      <Trigger Property="VirtualizingPanel.IsVirtualizing" Value="True">
        <Setter Property="ItemsPanel">
          <Setter.Value>
            <ItemsPanelTemplate>
              <VirtualizingStackPanel/>
            </ItemsPanelTemplate>
          </Setter.Value>
        </Setter>
      </Trigger>
      <Trigger Property="aero:TreeViewService.FullRowSelect" Value="True">
        <Setter Property="Template" Value="{StaticResource TreeViewItem.Template.FullRowSelect}"/>
      </Trigger>
      <Trigger Property="aero:ThemeOptions.UseExplorerStyle" Value="True">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="3,1,3,1"/>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
        <Setter Property="Template" Value="{StaticResource Explorer.TreeViewItem.Template.Default}"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="aero:TreeViewService.FullRowSelect" Value="True"/>
          <Condition Property="aero:ThemeOptions.UseExplorerStyle" Value="True"/>
        </MultiTrigger.Conditions>
        <Setter Property="Template" Value="{StaticResource Explorer.TreeViewItem.Template.FullRowSelect}"/>
      </MultiTrigger>
    </Style.Triggers>
  </Style>


  <!-- TabControl ========================================================== -->

  <Style TargetType="{x:Type TabControl}">
    <Setter Property="Padding" Value="6,4,6,6"/>
    <Setter Property="HorizontalContentAlignment" Value="Center"/>
    <Setter Property="VerticalContentAlignment" Value="Center"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Selected}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Selected}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type TabControl}">
          <Grid x:Name="TemplateRoot"
                        ClipToBounds="True"
                        SnapsToDevicePixels="True"
                        KeyboardNavigation.TabNavigation="Local">
            <Grid.ColumnDefinitions>
              <ColumnDefinition x:Name="ColumnDefinition0"/>
              <ColumnDefinition x:Name="ColumnDefinition1" Width="0"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition x:Name="RowDefinition0" Height="Auto"/>
              <RowDefinition x:Name="RowDefinition1" Height="*"/>
            </Grid.RowDefinitions>
            <TabPanel x:Name="HeaderPanel"
                      Background="Transparent"
                      IsItemsHost="True"
                      Margin="2,2,2,0"
                      KeyboardNavigation.TabIndex="1"
                      Panel.ZIndex="1"/>
            <Border x:Name="ContentPanel"
                    Grid.Row="1"
                    KeyboardNavigation.DirectionalNavigation="Contained"
                    KeyboardNavigation.TabNavigation="Local"
                    KeyboardNavigation.TabIndex="2"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}">
              <ContentPresenter x:Name="PART_SelectedContentHost"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                Margin="{TemplateBinding Padding}"
                                ContentSource="SelectedContent"/>
            </Border>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="TabStripPlacement" Value="Bottom">
              <Setter TargetName="HeaderPanel" Property="Grid.Row" Value="1"/>
              <Setter TargetName="ContentPanel" Property="Grid.Row" Value="0"/>
              <Setter TargetName="RowDefinition0" Property="Height" Value="*"/>
              <Setter TargetName="RowDefinition1" Property="Height" Value="Auto"/>
              <Setter TargetName="HeaderPanel" Property="Margin" Value="2,0,2,2"/>
            </Trigger>
            <Trigger Property="TabStripPlacement" Value="Left">
              <Setter TargetName="HeaderPanel" Property="Grid.Row" Value="0"/>
              <Setter TargetName="ContentPanel" Property="Grid.Row" Value="0"/>
              <Setter TargetName="HeaderPanel" Property="Grid.Column" Value="0"/>
              <Setter TargetName="ContentPanel" Property="Grid.Column" Value="1"/>
              <Setter TargetName="ColumnDefinition0" Property="Width" Value="Auto"/>
              <Setter TargetName="ColumnDefinition1" Property="Width" Value="*"/>
              <Setter TargetName="RowDefinition0" Property="Height" Value="*"/>
              <Setter TargetName="RowDefinition1" Property="Height" Value="0"/>
              <Setter TargetName="HeaderPanel" Property="Margin" Value="2,2,0,2"/>
            </Trigger>
            <Trigger Property="TabStripPlacement" Value="Right">
              <Setter TargetName="HeaderPanel" Property="Grid.Row" Value="0"/>
              <Setter TargetName="ContentPanel" Property="Grid.Row" Value="0"/>
              <Setter TargetName="HeaderPanel" Property="Grid.Column" Value="1"/>
              <Setter TargetName="ContentPanel" Property="Grid.Column" Value="0"/>
              <Setter TargetName="ColumnDefinition0" Property="Width" Value="*"/>
              <Setter TargetName="ColumnDefinition1" Property="Width" Value="Auto"/>
              <Setter TargetName="RowDefinition0" Property="Height" Value="*"/>
              <Setter TargetName="RowDefinition1" Property="Height" Value="0"/>
              <Setter TargetName="HeaderPanel" Property="Margin" Value="0,2,2,2"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="TemplateRoot" Property="TextElement.Foreground"
                      Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="TabItem.FocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Rectangle Margin="3,3,3,2"
                     SnapsToDevicePixels="True"
                     Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                     StrokeThickness="1"
                     StrokeDashArray="1 1"
                     StrokeDashOffset="1.5"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style TargetType="{x:Type TabItem}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource TabItem.FocusVisual}"/>
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Normal}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Normal}"/>
    <Setter Property="Margin" Value="0"/>
    <Setter Property="Padding" Value="5,0"/>
    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
    <Setter Property="VerticalContentAlignment" Value="Stretch"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type TabItem}">
          <Grid x:Name="TemplateRoot" SnapsToDevicePixels="True">
            <Border x:Name="Border"
                    BorderThickness="1,1,1,0"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    Padding="{TemplateBinding Padding}">
              <Border>
                <ContentPresenter x:Name="Content"
                                  ContentSource="Header"
                                  HorizontalAlignment="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                  VerticalAlignment="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                  Focusable="False"
                                  RecognizesAccessKey="True"/>
              </Border>
            </Border>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Hot}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Hot}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Content" Property="Opacity" Value="0.56"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Disabled}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Disabled}"/>
            </Trigger>
            <Trigger Property="IsSelected" Value="True">
              <Setter Property="Panel.ZIndex" Value="1"/>
              <Setter Property="Margin" Value="-2"/>
              <Setter Property="Padding" Value="5,0,5,4"/>
              <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Selected}"/>
              <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Selected}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="TabStripPlacement" Value="Bottom">
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="{x:Type TabItem}">
              <Grid x:Name="TemplateRoot" SnapsToDevicePixels="True">
                <Border x:Name="Border"
                        BorderThickness="1,1,1,0"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}">
                  <ContentPresenter x:Name="Content"
                                    ContentSource="Header"
                                    HorizontalAlignment="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                    VerticalAlignment="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                    Focusable="False"
                                    Margin="{TemplateBinding Padding}"
                                    RecognizesAccessKey="True"/>
                </Border>
              </Grid>
              <ControlTemplate.Triggers>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Hot}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Hot}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,0,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Hot}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Hot}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,0,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Hot}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Hot}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="0,1,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Hot}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Hot}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Content" Property="Opacity" Value="0.56"/>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,0,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Content" Property="Opacity" Value="0.56"/>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,0,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Content" Property="Opacity" Value="0.56"/>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="0,1,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Content" Property="Opacity" Value="0.56"/>
                  <Setter TargetName="Border" Property="Background" Value="{aero10:SystemAliasResource TabItem.Background.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderBrush" Value="{aero10:SystemAliasResource TabItem.Border.Disabled}"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,0,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Left"/>
                  </MultiDataTrigger.Conditions>
                  <Setter Property="Panel.ZIndex" Value="1"/>
                  <Setter Property="Margin" Value="-2,-2,0,-2"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,0,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,0,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Bottom"/>
                  </MultiDataTrigger.Conditions>
                  <Setter Property="Panel.ZIndex" Value="1"/>
                  <Setter Property="Margin" Value="-2,0,-2,-2"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,0,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="BorderThickness" Value="0,1,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Right"/>
                  </MultiDataTrigger.Conditions>
                  <Setter Property="Panel.ZIndex" Value="1"/>
                  <Setter Property="Margin" Value="0,-2,-2,-2"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="0,1,1,1"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                  </MultiDataTrigger.Conditions>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                </MultiDataTrigger>
                <MultiDataTrigger>
                  <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="True"/>
                    <Condition Binding="{Binding TabStripPlacement, RelativeSource={RelativeSource AncestorType={x:Type TabControl}}}" Value="Top"/>
                  </MultiDataTrigger.Conditions>
                  <Setter Property="Panel.ZIndex" Value="1"/>
                  <Setter Property="Margin" Value="-2,-2,-2,0"/>
                  <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                </MultiDataTrigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Trigger>
    </Style.Triggers>
  </Style>


  <!-- ProgressBar ========================================================= -->

  <BitmapImage x:Key="ProgressBar.MoveOverlay" CacheOption="OnLoad">
    <BitmapImage.StreamSource>
      <aero10:ColorizeByAlphaStreamSource
        UriSource="pack://application:,,,/PresentationTheme.HighContrast.Win10;component/Resources/Progress.MoveOverlay.png"
        Tint="{x:Static SystemColors.HighlightColor}"/>
    </BitmapImage.StreamSource>
  </BitmapImage>
  <BitmapImage x:Key="ProgressBar.PulseOverlay"
               BaseUri="pack://application:,,,/"
               UriSource="/PresentationTheme.HighContrast.Win10;component/Resources/Progress.PulseOverlay.png"/>

  <Style TargetType="{x:Type aero10:ProgressBarChrome}">
    <Setter Property="Foreground" Value="{x:Null}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource ProgressBar.Background}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ProgressBar.Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type aero10:ProgressBarChrome}">
          <Grid x:Name="TemplateRoot">
            <Border Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"/>

            <Rectangle x:Name="PART_Track"/>

            <Grid x:Name="PART_Indicator"
                  HorizontalAlignment="Left"
                  ClipToBounds="True"
                  Width="0">
              <Border x:Name="Indicator"
                      Margin="{TemplateBinding BorderThickness}"
                      Background="{TemplateBinding Foreground}"/>

              <Grid x:Name="PART_MoveOverlay"
                      Width="127"
                      Margin="-127,0,0,0"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Stretch"
                      Visibility="Collapsed">
                <Image x:Name="DeterminateOverlay"
                       Source="{StaticResource ProgressBar.MoveOverlay}"
                       Stretch="Fill"/>
                <Rectangle x:Name="IndeterminateOverlay"
                           Fill="{TemplateBinding Foreground}"
                           Visibility="Collapsed"/>
              </Grid>

              <Grid x:Name="PART_PulseOverlay"
                    Opacity="0"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Bottom"
                    Height="18"
                    Visibility="Collapsed">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="Auto"/>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Image Stretch="Fill">
                  <Image.Source>
                    <CroppedBitmap Source="{StaticResource ProgressBar.PulseOverlay}"
                                   SourceRect="0,0,21,18"/>
                  </Image.Source>
                </Image>
                <Image Stretch="Fill" Grid.Column="1">
                  <Image.Source>
                    <CroppedBitmap Source="{StaticResource ProgressBar.PulseOverlay}"
                                   SourceRect="21,0,1,18"/>
                  </Image.Source>
                </Image>
                <Image Stretch="Fill" Grid.Column="2">
                  <Image.Source>
                    <CroppedBitmap Source="{StaticResource ProgressBar.PulseOverlay}"
                                   SourceRect="22,0,20,18"/>
                  </Image.Source>
                </Image>
              </Grid>
            </Grid>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="Orientation" Value="Vertical">
              <Setter TargetName="TemplateRoot" Property="LayoutTransform">
                <Setter.Value>
                  <RotateTransform Angle="-90"/>
                </Setter.Value>
              </Setter>
            </Trigger>
            <Trigger Property="Foreground" Value="{x:Null}">
              <Setter TargetName="Indicator" Property="Background" Value="{aero10:SystemAliasResource ProgressBar.Fill.Background.Normal}"/>
              <Setter TargetName="Indicator" Property="BorderBrush" Value="{aero10:SystemAliasResource ProgressBar.Fill.Border.Normal}"/>
              <Setter TargetName="Indicator" Property="BorderThickness" Value="1"/>
              <Setter TargetName="Indicator" Property="Margin" Value="0"/>
              <Setter TargetName="IndeterminateOverlay" Property="Fill" Value="#FF00D228"/>
              <Setter TargetName="PART_MoveOverlay" Property="Visibility" Value="Visible"/>
              <Setter TargetName="PART_PulseOverlay" Property="Visibility" Value="Visible"/>
            </Trigger>
            <DataTrigger Value="True">
              <DataTrigger.Binding>
                <MultiBinding Converter="{StaticResource EqualsConverter}">
                  <Binding Path="Value" RelativeSource="{RelativeSource Self}"/>
                  <Binding Path="Maximum" RelativeSource="{RelativeSource Self}"/>
                </MultiBinding>
              </DataTrigger.Binding>
              <Setter TargetName="PART_MoveOverlay" Property="Visibility" Value="Collapsed"/>
              <Setter TargetName="PART_PulseOverlay" Property="Visibility" Value="Collapsed"/>
            </DataTrigger>
            <Trigger Property="IsIndeterminate" Value="True">
              <Setter TargetName="Indicator" Property="Visibility" Value="Collapsed"/>
              <Setter TargetName="DeterminateOverlay" Property="Visibility" Value="Collapsed"/>
              <Setter TargetName="IndeterminateOverlay" Property="Visibility" Value="Visible"/>
              <Setter TargetName="PART_MoveOverlay" Property="Visibility" Value="Visible"/>
              <Setter TargetName="PART_PulseOverlay" Property="Visibility" Value="Visible"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style TargetType="{x:Type ProgressBar}">
    <Setter Property="Foreground" Value="{x:Null}"/>
    <Setter Property="Background" Value="{aero10:SystemAliasResource ProgressBar.Background}"/>
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ProgressBar.Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ProgressBar}">
          <aero10:ProgressBarChrome
            Style="{StaticResource {x:Type aero10:ProgressBarChrome}}"
            Bar="{Binding RelativeSource={RelativeSource TemplatedParent}}"
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
    <Style.Triggers>
      <Trigger Property="IsIndeterminate" Value="True">
        <Setter Property="Background" Value="{aero10:SystemAliasResource ProgressBar.Indeterminate.Background}"/>
        <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource ProgressBar.Indeterminate.Border}"/>
        <Setter Property="BorderThickness" Value="0"/>
      </Trigger>
    </Style.Triggers>
  </Style>


  <!-- Slider ============================================================== -->

  <ControlTemplate x:Key="SliderThumbHorizontal" TargetType="{x:Type Thumb}">
    <Grid HorizontalAlignment="Center"
          VerticalAlignment="Center"
          UseLayoutRounding="True">
      <Path x:Name="Grip"
            Data="M0,0 10,0 10,21 0,21 z"
            SnapsToDevicePixels="True"
            VerticalAlignment="Center"
            UseLayoutRounding="True"
            Stretch="Fill"
            Fill="{aero10:SystemAliasResource Slider.Thumb.Background.Normal}"
            Stroke="{aero10:SystemAliasResource Slider.Thumb.Border.Normal}"
            StrokeThickness="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.Thumb.Background.Hot}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.Thumb.Border.Hot}"/>
      </Trigger>
      <Trigger Property="IsDragging" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.Thumb.Background.Pressed}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.Thumb.Border.Pressed}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.Thumb.Background.Disabled}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.Thumb.Border.Disabled}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="SliderThumbHorizontalTop" TargetType="{x:Type Thumb}">
    <Grid HorizontalAlignment="Center"
          VerticalAlignment="Center"
          UseLayoutRounding="True">
      <Path x:Name="Grip"
            Data="M0,18 11,18 11,5 5.5,-0.5 0,5 z"
            SnapsToDevicePixels="True"
            VerticalAlignment="Center"
            UseLayoutRounding="True"
            Stretch="Fill"
            Margin="0,0,0,1"
            Fill="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Normal}"
            Stroke="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Normal}"
            StrokeThickness="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Hot}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Hot}"/>
      </Trigger>
      <Trigger Property="IsDragging" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Pressed}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Pressed}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Disabled}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Disabled}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="SliderThumbHorizontalBottom" TargetType="{x:Type Thumb}">
    <Grid HorizontalAlignment="Center" VerticalAlignment="Center" UseLayoutRounding="True">
      <Path x:Name="Grip"
            Data="M0,0 11,0 11,13 5.5,18.5 0,13 z"
            SnapsToDevicePixels="True"
            VerticalAlignment="Center"
            UseLayoutRounding="True"
            Stretch="Fill"
            Margin="0,0,0,1"
            Fill="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Normal}"
            Stroke="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Normal}"
            StrokeThickness="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Hot}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Hot}"/>
      </Trigger>
      <Trigger Property="IsDragging" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Pressed}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Pressed}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Disabled}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Disabled}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="SliderHorizontal" TargetType="{x:Type Slider}">
    <Border x:Name="Border"
            SnapsToDevicePixels="True"
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            VerticalAlignment="Top">
      <Grid Margin="8,0">
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <aero10:TickBarEx x:Name="TopTick"
                          Height="4"
                          Placement="Top"
                          Visibility="Collapsed"
                          Margin="0,5,0,0"
                          Fill="{TemplateBinding Foreground}"/>
        <aero10:TickBarEx x:Name="BottomTick"
                          Grid.Row="2"
                          Height="4"
                          Placement="Bottom"
                          Visibility="Collapsed"
                          Margin="0,0,0,5"
                          Fill="{TemplateBinding Foreground}"/>
        <Border x:Name="TrackBackground"
                Grid.Row="1"
                BorderThickness="1"
                Height="4"
                Margin="0,0,0,2"
                VerticalAlignment="center"
                BorderBrush="{aero10:SystemAliasResource Slider.Track.Border}"
                Background="{aero10:SystemAliasResource Slider.Track.Background}">
          <Canvas Margin="-1,0">
            <Rectangle x:Name="PART_SelectionRange"
                       Height="6"
                       Margin="0,2"
                       Visibility="Hidden"
                       Fill="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
          </Canvas>
        </Border>
        <Track x:Name="PART_Track" Grid.Row="1" Margin="0,2">
          <Track.DecreaseRepeatButton>
            <RepeatButton Command="{x:Static Slider.DecreaseLarge}"
                          Style="{StaticResource RepeatButtonTransparent}"/>
          </Track.DecreaseRepeatButton>
          <Track.IncreaseRepeatButton>
            <RepeatButton Command="{x:Static Slider.IncreaseLarge}"
                          Style="{StaticResource RepeatButtonTransparent}"/>
          </Track.IncreaseRepeatButton>
          <Track.Thumb>
            <Thumb x:Name="Thumb"
                   OverridesDefaultStyle="True"
                   Focusable="False"
                   VerticalAlignment="Center"
                   Template="{StaticResource SliderThumbHorizontalBottom}"
                   Width="11"
                   Height="19"/>
          </Track.Thumb>
        </Track>
      </Grid>
    </Border>
    <ControlTemplate.Triggers>
      <Trigger Property="TickPlacement" Value="TopLeft">
        <Setter TargetName="TopTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Thumb" Property="Template" Value="{StaticResource SliderThumbHorizontalTop}"/>
        <Setter TargetName="TrackBackground" Property="Margin" Value="0,1,0,0"/>
        <Setter TargetName="PART_Track" Property="Margin" Value="0,1,0,2"/>
      </Trigger>
      <Trigger Property="TickPlacement" Value="BottomRight">
        <Setter TargetName="BottomTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Thumb" Property="Template" Value="{StaticResource SliderThumbHorizontalBottom}"/>
        <Setter TargetName="TrackBackground" Property="Margin" Value="0,0,0,2"/>
        <Setter TargetName="PART_Track" Property="Margin" Value="0,2,0,1"/>
      </Trigger>
      <Trigger Property="TickPlacement" Value="Both">
        <Setter TargetName="TopTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="BottomTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Thumb" Property="Template" Value="{StaticResource SliderThumbHorizontal}"/>
        <Setter TargetName="Thumb" Property="Width" Value="11"/>
        <Setter TargetName="Thumb" Property="Height" Value="22"/>
        <Setter TargetName="TrackBackground" Property="Margin" Value="0,0,0,0"/>
        <Setter TargetName="PART_Track" Property="Margin" Value="0,1"/>
      </Trigger>
      <Trigger Property="IsSelectionRangeEnabled" Value="True">
        <Setter TargetName="TrackBackground" Property="Height" Value="12"/>
        <Setter TargetName="PART_SelectionRange" Property="Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelectionRangeEnabled" Value="True"/>
          <Condition Property="TickPlacement" Value="Both"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Thumb" Property="Width" Value="11"/>
        <Setter TargetName="Thumb" Property="Height" Value="24"/>
        <Setter TargetName="PART_SelectionRange" Property="Height" Value="12"/>
        <Setter TargetName="TrackBackground" Property="Height" Value="18"/>
      </MultiTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="SliderThumbVertical" TargetType="{x:Type Thumb}">
    <Grid HorizontalAlignment="Center"
          VerticalAlignment="Center"
          UseLayoutRounding="True">
      <Path x:Name="Grip"
            Data="M0,0 0,10 21,10 21,0 z"
            SnapsToDevicePixels="True"
            VerticalAlignment="Center"
            UseLayoutRounding="True"
            Stretch="Fill"
            Fill="{aero10:SystemAliasResource Slider.Thumb.Background.Normal}"
            Stroke="{aero10:SystemAliasResource Slider.Thumb.Border.Normal}"
            StrokeThickness="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.Thumb.Background.Hot}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.Thumb.Border.Hot}"/>
      </Trigger>
      <Trigger Property="IsDragging" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.Thumb.Background.Pressed}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.Thumb.Border.Pressed}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.Thumb.Background.Disabled}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.Thumb.Border.Disabled}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="SliderThumbVerticalLeft" TargetType="{x:Type Thumb}">
    <Grid HorizontalAlignment="Center"
          VerticalAlignment="Center"
          UseLayoutRounding="True">
      <Path x:Name="Grip"
            Data="M19,0 19,11 6,11 0.5,5.5 6,0 z"
            Stretch="Fill"
            Margin="1,0,0,0"
            Fill="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Normal}"
            Stroke="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Normal}"
            StrokeThickness="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Hot}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Hot}"/>
      </Trigger>
      <Trigger Property="IsDragging" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Pressed}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Pressed}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Disabled}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Disabled}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="SliderThumbVerticalRight" TargetType="{x:Type Thumb}">
    <Grid HorizontalAlignment="Center"
          VerticalAlignment="Center"
          UseLayoutRounding="True">
      <Path x:Name="Grip"
            Data="M0,0 0,11 13,11 18.5,5.5 13,0 z"
            Stretch="Fill"
            Margin="0,0,1,0"
            Fill="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Normal}"
            Stroke="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Normal}"
            StrokeThickness="1"/>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Hot}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Hot}"/>
      </Trigger>
      <Trigger Property="IsDragging" Value="True">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Pressed}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Pressed}"/>
      </Trigger>
      <Trigger Property="IsEnabled" Value="False">
        <Setter TargetName="Grip" Property="Fill" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Background.Disabled}"/>
        <Setter TargetName="Grip" Property="Stroke" Value="{aero10:SystemAliasResource Slider.ThumbTLBR.Border.Disabled}"/>
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <ControlTemplate x:Key="SliderVertical" TargetType="{x:Type Slider}">
    <Border x:Name="Border"
            SnapsToDevicePixels="True"
            Background="{TemplateBinding Background}"
            BorderBrush="{TemplateBinding BorderBrush}"
            BorderThickness="{TemplateBinding BorderThickness}"
            HorizontalAlignment="Left">
      <Grid Margin="0,8">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto" MinWidth="{TemplateBinding MinWidth}"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <aero10:TickBarEx x:Name="TopTick"
                          Width="4"
                          Placement="Left"
                          Visibility="Collapsed"
                          Margin="5,0,0,0"
                          Fill="{TemplateBinding Foreground}"/>
        <aero10:TickBarEx x:Name="BottomTick"
                          Grid.Column="2"
                          Width="4"
                          Placement="Right"
                          Visibility="Collapsed"
                          Margin="0,0,5,0"
                          Fill="{TemplateBinding Foreground}"/>
        <Border x:Name="TrackBackground"
                Grid.Column="1"
                BorderThickness="1"
                Width="4"
                Margin="0,0,2,0"
                HorizontalAlignment="Center"
                BorderBrush="{aero10:SystemAliasResource Slider.Track.Border}"
                Background="{aero10:SystemAliasResource Slider.Track.Background}">
          <Canvas Margin="0,-1">
            <Rectangle x:Name="PART_SelectionRange"
                       Width="6"
                       Margin="2,0"
                       Visibility="Hidden"
                       Fill="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
          </Canvas>
        </Border>
        <Track x:Name="PART_Track" Grid.Column="1" Margin="2,0">
          <Track.DecreaseRepeatButton>
            <RepeatButton Command="{x:Static Slider.DecreaseLarge}"
                          Style="{StaticResource RepeatButtonTransparent}"/>
          </Track.DecreaseRepeatButton>
          <Track.IncreaseRepeatButton>
            <RepeatButton Command="{x:Static Slider.IncreaseLarge}"
                          Style="{StaticResource RepeatButtonTransparent}"/>
          </Track.IncreaseRepeatButton>
          <Track.Thumb>
            <Thumb x:Name="Thumb"
                   OverridesDefaultStyle="True"
                   Focusable="False"
                   HorizontalAlignment="Center"
                   Width="19"
                   Height="11"
                   Template="{StaticResource SliderThumbVerticalRight}"/>
          </Track.Thumb>
        </Track>
      </Grid>
    </Border>
    <ControlTemplate.Triggers>
      <Trigger Property="TickPlacement" Value="TopLeft">
        <Setter TargetName="TopTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Thumb" Property="Template" Value="{StaticResource SliderThumbVerticalLeft}"/>
        <Setter TargetName="TrackBackground" Property="Margin" Value="1,0,0,0"/>
        <Setter TargetName="PART_Track" Property="Margin" Value="1,0,2,0"/>
      </Trigger>
      <Trigger Property="TickPlacement" Value="BottomRight">
        <Setter TargetName="BottomTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Thumb" Property="Template" Value="{StaticResource SliderThumbVerticalRight}"/>
        <Setter TargetName="TrackBackground" Property="Margin" Value="0,0,2,0"/>
        <Setter TargetName="PART_Track" Property="Margin" Value="2,0,1,0"/>
      </Trigger>
      <Trigger Property="TickPlacement" Value="Both">
        <Setter TargetName="TopTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="BottomTick" Property="Visibility" Value="Visible"/>
        <Setter TargetName="Thumb" Property="Template" Value="{StaticResource SliderThumbVertical}"/>
        <Setter TargetName="Thumb" Property="Width" Value="22"/>
        <Setter TargetName="Thumb" Property="Height" Value="11"/>
        <Setter TargetName="TrackBackground" Property="Margin" Value="0"/>
        <Setter TargetName="PART_Track" Property="Margin" Value="1,0"/>
      </Trigger>
      <Trigger Property="IsSelectionRangeEnabled" Value="True">
        <Setter TargetName="TrackBackground" Property="Width" Value="12"/>
        <Setter TargetName="PART_SelectionRange" Property="Visibility" Value="Visible"/>
      </Trigger>
      <MultiTrigger>
        <MultiTrigger.Conditions>
          <Condition Property="IsSelectionRangeEnabled" Value="True"/>
          <Condition Property="TickPlacement" Value="Both"/>
        </MultiTrigger.Conditions>
        <Setter TargetName="Thumb" Property="Width" Value="24"/>
        <Setter TargetName="Thumb" Property="Height" Value="11"/>
        <Setter TargetName="PART_SelectionRange" Property="Width" Value="12"/>
        <Setter TargetName="TrackBackground" Property="Width" Value="18"/>
      </MultiTrigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>

  <Style TargetType="{x:Type Slider}">
    <Setter Property="Stylus.IsPressAndHoldEnabled" Value="False"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="Foreground" Value="{aero10:SystemAliasResource Slider.Thumb.Foreground.Normal}"/>
    <Setter Property="Template" Value="{StaticResource SliderHorizontal}"/>
    <Style.Triggers>
      <Trigger Property="Orientation" Value="Vertical">
        <Setter Property="Template" Value="{StaticResource SliderVertical}"/>
      </Trigger>
    </Style.Triggers>
  </Style>


  <!-- GroupBox ============================================================== -->

  <BorderGapMaskConverter x:Key="BorderGapMaskConverter"/>

  <Style x:Key="{x:Type GroupBox}" TargetType="{x:Type GroupBox}">
    <Setter Property="BorderBrush" Value="{aero10:SystemAliasResource GroupBox.Border}"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type GroupBox}">
          <Grid SnapsToDevicePixels="True">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="6"/>
              <ColumnDefinition Width="Auto"/>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="6"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="Auto"/>
              <RowDefinition Height="*"/>
              <RowDefinition Height="6"/>
            </Grid.RowDefinitions>
            <Border Grid.Row="1"
                    Grid.RowSpan="3"
                    Grid.ColumnSpan="4"
                    Background="{TemplateBinding Background}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    BorderBrush="Transparent"/>

            <Border Grid.Row="1"
                    Grid.RowSpan="3"
                    Grid.ColumnSpan="4"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    CornerRadius="2"
                    SnapsToDevicePixels="True">
              <Border.OpacityMask>
                <MultiBinding Converter="{StaticResource BorderGapMaskConverter}"
                              ConverterParameter="7">
                  <Binding Path="ActualWidth" ElementName="Header"/>
                  <Binding Path="ActualWidth" RelativeSource="{RelativeSource Self}"/>
                  <Binding Path="ActualHeight" RelativeSource="{RelativeSource Self}"/>
                </MultiBinding>
              </Border.OpacityMask>
              <Border BorderBrush="{TemplateBinding BorderBrush}"
                      BorderThickness="{TemplateBinding BorderThickness}"
                      SnapsToDevicePixels="True"/>
            </Border>

            <Border x:Name="Header"
                    Padding="3,0,1,0"
                    Grid.RowSpan="2"
                    Grid.Column="1">
              <ContentPresenter ContentSource="Header"
                                RecognizesAccessKey="True"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </Border>
            <ContentPresenter Grid.Row="2"
                              Grid.Column="1"
                              Grid.ColumnSpan="2"
                              Margin="{TemplateBinding Padding}"
                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>


  <!-- Expander ============================================================== -->

  <SolidColorBrush x:Key="Expander.Glyph.Normal"
                   Color="{DynamicResource {x:Static SystemColors.ControlTextColorKey}}"
                   Opacity="0.5"/>
  <SolidColorBrush x:Key="Expander.Glyph.Hot"
                   Color="{DynamicResource {x:Static SystemColors.ControlTextColorKey}}"
                   Opacity="0.75"/>
  <SolidColorBrush x:Key="Expander.Glyph.Pressed"
                   Color="{DynamicResource {x:Static SystemColors.ControlTextColorKey}}"
                   Opacity="0.75"/>

  <Geometry x:Key="ExpanderGlyphCollapsed">
    F1 M0.88,2.12 2.119,0.881 6.119,4.881 6.737,5.5 2.119,10.119 0.881,8.881 4.881,4.881 5.5,5.5 4.881,6.119 0.881,2.119 z
  </Geometry>

  <Geometry x:Key="ExpanderGlyphExpanded">
    F1 M0.88,2.12 2.119,0.881 6.119,4.881 5.5,5.5 4.881,4.881 8.881,0.881 10.119,2.119 5.5,6.737 4.881,6.119 0.881,2.119 z
  </Geometry>

  <Style x:Key="ExpanderHeaderFocusVisual">
    <Setter Property="Control.Template">
      <Setter.Value>
        <ControlTemplate>
          <Border>
            <Rectangle Margin="-1"
                       SnapsToDevicePixels="True"
                       Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                       StrokeThickness="1"
                       StrokeDashArray="1 1"
                       StrokeDashOffset="1.5"/>
          </Border>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ExpanderDownHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border Background="Transparent" Padding="{TemplateBinding Padding}">
            <Grid SnapsToDevicePixels="False">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="19"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>
              <Path x:Name="Glyph"
                    Data="{StaticResource ExpanderGlyphCollapsed}"
                    Fill="{StaticResource Expander.Glyph.Normal}"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    SnapsToDevicePixels="False"/>
              <ContentPresenter Grid.Column="1"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                SnapsToDevicePixels="True"
                                RecognizesAccessKey="True"/>
            </Grid>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="Glyph" Property="Data" Value="{StaticResource ExpanderGlyphExpanded}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Glyph" Property="Fill" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ExpanderUpHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border Background="Transparent" Padding="{TemplateBinding Padding}">
            <Grid SnapsToDevicePixels="False">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="19"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>
              <Grid>
                <Grid.LayoutTransform>
                  <TransformGroup>
                    <TransformGroup.Children>
                      <RotateTransform Angle="-180"/>
                    </TransformGroup.Children>
                  </TransformGroup>
                </Grid.LayoutTransform>
                <Path x:Name="Glyph"
                      Data="{StaticResource ExpanderGlyphCollapsed}"
                      Fill="{StaticResource Expander.Glyph.Normal}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      SnapsToDevicePixels="False"/>
              </Grid>
              <ContentPresenter Grid.Column="1"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                SnapsToDevicePixels="True"
                                RecognizesAccessKey="True"/>
            </Grid>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="Glyph" Property="Data" Value="{StaticResource ExpanderGlyphExpanded}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Glyph" Property="Fill" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ExpanderLeftHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border Background="Transparent" Padding="{TemplateBinding Padding}">
            <Grid SnapsToDevicePixels="False">
              <Grid.RowDefinitions>
                <RowDefinition Height="19"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>
              <Grid>
                <Grid.LayoutTransform>
                  <TransformGroup>
                    <TransformGroup.Children>
                      <RotateTransform Angle="90"/>
                    </TransformGroup.Children>
                  </TransformGroup>
                </Grid.LayoutTransform>
                <Path x:Name="Glyph"
                      Data="{StaticResource ExpanderGlyphCollapsed}"
                      Fill="{StaticResource Expander.Glyph.Normal}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      SnapsToDevicePixels="False"/>
              </Grid>
              <ContentPresenter Grid.Row="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Top"
                                SnapsToDevicePixels="True"
                                RecognizesAccessKey="True"/>
            </Grid>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="Glyph" Property="Data" Value="{StaticResource ExpanderGlyphExpanded}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Glyph" Property="Fill" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="ExpanderRightHeaderStyle" TargetType="{x:Type ToggleButton}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ToggleButton}">
          <Border Background="Transparent" Padding="{TemplateBinding Padding}">
            <Grid SnapsToDevicePixels="False">
              <Grid.RowDefinitions>
                <RowDefinition Height="19"/>
                <RowDefinition Height="*"/>
              </Grid.RowDefinitions>
              <Grid x:Name="Grid">
                <Grid.LayoutTransform>
                  <RotateTransform Angle="90"/>
                </Grid.LayoutTransform>
                <Path x:Name="Glyph"
                      Data="{StaticResource ExpanderGlyphCollapsed}"
                      Fill="{StaticResource Expander.Glyph.Normal}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      SnapsToDevicePixels="False"/>
              </Grid>
              <ContentPresenter Grid.Row="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Top"
                                SnapsToDevicePixels="True"
                                RecognizesAccessKey="True"/>
            </Grid>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsChecked" Value="True">
              <Setter TargetName="Glyph" Property="Data" Value="{StaticResource ExpanderGlyphExpanded}"/>
              <Setter TargetName="Grid" Property="LayoutTransform">
                <Setter.Value>
                  <RotateTransform Angle="-90"/>
                </Setter.Value>
              </Setter>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Hot}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource Expander.Glyph.Pressed}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter TargetName="Glyph" Property="Fill" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>

  <Style x:Key="{x:Type Expander}" TargetType="{x:Type Expander}">
    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="BorderBrush" Value="Transparent"/>
    <Setter Property="BorderThickness" Value="1"/>
    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
    <Setter Property="VerticalContentAlignment" Value="Stretch"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type Expander}">
          <Border BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}"
                  Background="{TemplateBinding Background}"
                  SnapsToDevicePixels="True">
            <DockPanel>
              <ToggleButton x:Name="HeaderSite"
                            DockPanel.Dock="Top"
                            Margin="1"
                            MinWidth="0"
                            MinHeight="0"
                            Style="{StaticResource ExpanderDownHeaderStyle}"
                            FocusVisualStyle="{StaticResource ExpanderHeaderFocusVisual}"
                            IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                            Content="{TemplateBinding Header}"
                            ContentTemplate="{TemplateBinding HeaderTemplate}"
                            ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                            Foreground="{TemplateBinding Foreground}"
                            Padding="{TemplateBinding Padding}"
                            FontFamily="{TemplateBinding FontFamily}"
                            FontSize="{TemplateBinding FontSize}"
                            FontStyle="{TemplateBinding FontStyle}"
                            FontStretch="{TemplateBinding FontStretch}"
                            FontWeight="{TemplateBinding FontWeight}"
                            HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                            VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
              <ContentPresenter x:Name="ExpandSite"
                                DockPanel.Dock="Bottom"
                                Visibility="Collapsed"
                                Focusable="False"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Margin="{TemplateBinding Padding}"/>
            </DockPanel>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsExpanded" Value="True">
              <Setter TargetName="ExpandSite" Property="Visibility" Value="Visible"/>
            </Trigger>
            <Trigger Property="ExpandDirection" Value="Right">
              <Setter TargetName="ExpandSite" Property="DockPanel.Dock" Value="Right"/>
              <Setter TargetName="HeaderSite" Property="DockPanel.Dock" Value="Left"/>
              <Setter TargetName="HeaderSite" Property="Style" Value="{StaticResource ExpanderRightHeaderStyle}"/>
            </Trigger>
            <Trigger Property="ExpandDirection" Value="Up">
              <Setter TargetName="ExpandSite" Property="DockPanel.Dock" Value="Top"/>
              <Setter TargetName="HeaderSite" Property="DockPanel.Dock" Value="Bottom"/>
              <Setter TargetName="HeaderSite" Property="Style" Value="{StaticResource ExpanderUpHeaderStyle}"/>
            </Trigger>
            <Trigger Property="ExpandDirection" Value="Left">
              <Setter TargetName="ExpandSite" Property="DockPanel.Dock" Value="Left"/>
              <Setter TargetName="HeaderSite" Property="DockPanel.Dock" Value="Right"/>
              <Setter TargetName="HeaderSite" Property="Style" Value="{StaticResource ExpanderLeftHeaderStyle}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter Property="Foreground"
                      Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>


  <!-- ResizeGrip ========================================================== -->

  <Style x:Key="{x:Type ResizeGrip}" TargetType="{x:Type ResizeGrip}">
    <Setter Property="MinWidth"
            Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
    <Setter Property="MinHeight"
            Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="Padding" Value="0,0,3,2"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type ResizeGrip}">
          <Grid SnapsToDevicePixels="True" Background="{TemplateBinding Background}">
            <Path Data="M 0,6 2,6 2,8 0,8  M 3,6 5,6 5,8 3,8  M 6,6 8,6 8,8 6,8  M 3,3 5,3 5,5 3,5  M 6,3 8,3 8,5 6,5  M 6,0 8,0 8,2 6,2"
                  Fill="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"
                  Margin="{TemplateBinding Padding}"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Bottom"/>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
</ResourceDictionary>
